<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Francesco Maria Sabatini" />
  <meta name="author" content="Rafael Barreto de Andrade" />
  <meta name="author" content="Yoan Paillet" />
  <meta name="author" content="Peter Ódor" />
  <meta name="author" content="Christophe Bouget" />
  <meta name="author" content="Thomas Campagnaro" />
  <meta name="author" content="Frédéric Gosselin" />
  <meta name="author" content="Philippe Janssen" />
  <meta name="author" content="Walter Mattioli" />
  <meta name="author" content="Juri Nascimbene" />
  <meta name="author" content="Tommaso Sitzia" />
  <meta name="author" content="Tobias Kuemmerle" />
  <meta name="author" content="Sabina Burrascano" />
  <meta name="dcterms.date" content="2020-04-19" />
  <meta name="keywords" content="markdown, publishing, manubot" />
  <title>Manuscript Title</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <!--
  Manubot generated metadata rendered from header-includes-template.html.
  Suggest improvements at https://github.com/manubot/manubot/blob/master/manubot/process/header-includes-template.html
  -->
  <meta name="dc.format" content="text/html" />
  <meta name="dc.title" content="Manuscript Title" />
  <meta name="citation_title" content="Manuscript Title" />
  <meta property="og:title" content="Manuscript Title" />
  <meta property="twitter:title" content="Manuscript Title" />
  <meta name="dc.date" content="2020-04-19" />
  <meta name="citation_publication_date" content="2020-04-19" />
  <meta name="dc.language" content="en-US" />
  <meta name="citation_language" content="en-US" />
  <meta name="dc.relation.ispartof" content="Manubot" />
  <meta name="dc.publisher" content="Manubot" />
  <meta name="citation_journal_title" content="Manubot" />
  <meta name="citation_technical_report_institution" content="Manubot" />
  <meta name="citation_author" content="Francesco Maria Sabatini" />
  <meta name="citation_author_institution" content="Geography Department, Humboldt-Universität zu Berlin. Unter den Linden 6, 10099, Berlin. Germany" />
  <meta name="citation_author_institution" content="German Centre for Integrative Biodiversity Research (iDiv) - Halle-Jena-Leipzig. Germany" />
  <meta name="citation_author_institution" content="Martin-Luther-Universität Halle-Wittenberg, Institut für Biologie, Am Kirchtor 1, 06108, Halle (Saale). Germany" />
  <meta name="citation_author_orcid" content="0000-0002-7202-7697" />
  <meta name="twitter:creator" content="@sPlot-iDiv" />
  <meta name="citation_author" content="Rafael Barreto de Andrade" />
  <meta name="citation_author_institution" content="Sapienza, University of Rome. P.le Aldo Moro 5, 00185 Rome, Italy" />
  <meta name="citation_author_orcid" content="0000-0002-7976-7647" />
  <meta name="citation_author" content="Yoan Paillet" />
  <meta name="citation_author_institution" content="Irstea, UR EFNO, Domaine des Barres, 45290 Nogent sur Vernisson, France" />
  <meta name="citation_author_orcid" content="0000-0001-7232-7844" />
  <meta name="citation_author" content="Peter Ódor" />
  <meta name="citation_author_institution" content="MTA Centre for Ecological Research, Institute of Ecology and Botany, H-2163 Vácrátót, Alkotmány u. 2-4., Hungary" />
  <meta name="citation_author_orcid" content="0000-0003-1729-8897" />
  <meta name="citation_author" content="Christophe Bouget" />
  <meta name="citation_author_institution" content="Irstea, UR EFNO, Domaine des Barres, 45290 Nogent sur Vernisson, France" />
  <meta name="citation_author_orcid" content="0000-0002-5206-7560" />
  <meta name="citation_author" content="Thomas Campagnaro" />
  <meta name="citation_author_institution" content="Department of Land, Environment, Agriculture and Forestry, Università degli Studi di Padova, I-35020 Legnaro (PD), Italy" />
  <meta name="citation_author_orcid" content="0000-0002-6307-6892" />
  <meta name="citation_author" content="Frédéric Gosselin" />
  <meta name="citation_author_institution" content="Irstea, UR EFNO, Domaine des Barres, 45290 Nogent sur Vernisson, France" />
  <meta name="citation_author_orcid" content="0000-0003-3737-106X" />
  <meta name="citation_author" content="Philippe Janssen" />
  <meta name="citation_author_institution" content="Université Grenoble-Alpes, Irstea, UR LESSEM, 2 rue de la Papeterie BP 76, 38402 Saint-Martin-d’Hères, France" />
  <meta name="citation_author_orcid" content="0000-0003-3310-0078" />
  <meta name="citation_author" content="Walter Mattioli" />
  <meta name="citation_author_institution" content="Council for Agricultural Research and Economics, Research Centre for Forestry and Wood (CREA-FL), v.le Santa Margherita 80, I-52100 Arezzo (AR), Italy" />
  <meta name="citation_author_orcid" content="0000-0003-2107-1038" />
  <meta name="citation_author" content="Juri Nascimbene" />
  <meta name="citation_author_institution" content="University of Bologna, Department of Biological, Geological and Environmental Sciences, via Irnerio 42, 40126 Bologna" />
  <meta name="citation_author_orcid" content="0000-0002-9174-654X" />
  <meta name="citation_author" content="Tommaso Sitzia" />
  <meta name="citation_author_institution" content="Department of Land, Environment, Agriculture and Forestry, Università degli Studi di Padova, I-35020 Legnaro (PD), Italy" />
  <meta name="citation_author_orcid" content="0000-0001-6221-4256" />
  <meta name="citation_author" content="Tobias Kuemmerle" />
  <meta name="citation_author_institution" content="Geography Department, Humboldt-Universität zu Berlin. Unter den Linden 6, 10099 Berlin, Germany" />
  <meta name="citation_author_institution" content="Integrative Research Institute for Human Environment Transformation (IRI THESys), Humboldt-Universität zu Berlin. Unter den Linden 6, 10099 Berlin, Germany" />
  <meta name="citation_author_orcid" content="0000-0002-9775-142X" />
  <meta name="citation_author" content="Sabina Burrascano" />
  <meta name="citation_author_institution" content="Sapienza, University of Rome. P.le Aldo Moro 5, 00185 Rome, Italy" />
  <meta name="citation_author_orcid" content="0000-0002-6537-3313" />
  <link rel="canonical" href="https://fmsabatini.github.io/TestManubot/" />
  <meta property="og:url" content="https://fmsabatini.github.io/TestManubot/" />
  <meta property="twitter:url" content="https://fmsabatini.github.io/TestManubot/" />
  <meta name="citation_fulltext_html_url" content="https://fmsabatini.github.io/TestManubot/" />
  <meta name="citation_pdf_url" content="https://fmsabatini.github.io/TestManubot/manuscript.pdf" />
  <link rel="alternate" type="application/pdf" href="https://fmsabatini.github.io/TestManubot/manuscript.pdf" />
  <link rel="alternate" type="text/html" href="https://fmsabatini.github.io/TestManubot/v/cc331cbc68d425c712a0e868d23c519a3d66223e/" />
  <meta name="manubot_html_url_versioned" content="https://fmsabatini.github.io/TestManubot/v/cc331cbc68d425c712a0e868d23c519a3d66223e/" />
  <meta name="manubot_pdf_url_versioned" content="https://fmsabatini.github.io/TestManubot/v/cc331cbc68d425c712a0e868d23c519a3d66223e/manuscript.pdf" />
  <meta property="og:type" content="article" />
  <meta property="twitter:card" content="summary_large_image" />
  <link rel="icon" type="image/png" sizes="192x192" href="https://manubot.org/favicon-192x192.png" />
  <link rel="mask-icon" href="https://manubot.org/safari-pinned-tab.svg" color="#ad1457" />
  <meta name="theme-color" content="#ad1457" />
  <!-- end Manubot generated metadata -->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Manuscript Title</h1>
</header>
<p><small><em>
This manuscript
(<a href="https://fmsabatini.github.io/TestManubot/v/cc331cbc68d425c712a0e868d23c519a3d66223e/">permalink</a>)
was automatically generated
from <a href="https://github.com/fmsabatini/TestManubot/tree/cc331cbc68d425c712a0e868d23c519a3d66223e">fmsabatini/TestManubot@cc331cb</a>
on April 19, 2020.
</em></small></p>
<h2 id="authors">Authors</h2>
<ul>
<li><p><strong>Francesco Maria Sabatini</strong> <sup><a href="#correspondence">✉</a></sup><br>
<img src="images/orcid.svg" class="inline_icon" alt="ORCID icon" />
<a href="https://orcid.org/0000-0002-7202-7697">0000-0002-7202-7697</a>
· <img src="images/github.svg" class="inline_icon" alt="GitHub icon" />
<a href="https://github.com/fmsabatini">fmsabatini</a>
· <img src="images/twitter.svg" class="inline_icon" alt="Twitter icon" />
<a href="https://twitter.com/sPlot-iDiv">sPlot-iDiv</a><br>
<small>
Geography Department, Humboldt-Universität zu Berlin. Unter den Linden 6, 10099, Berlin. Germany; German Centre for Integrative Biodiversity Research (iDiv) - Halle-Jena-Leipzig. Germany; Martin-Luther-Universität Halle-Wittenberg, Institut für Biologie, Am Kirchtor 1, 06108, Halle (Saale). Germany
· Funded by Grant No. 658876 - Marie Skłodowska-Curie
</small></p></li>
<li><p><strong>Rafael Barreto de Andrade</strong> <br>
<img src="images/orcid.svg" class="inline_icon" alt="ORCID icon" />
<a href="https://orcid.org/0000-0002-7976-7647">0000-0002-7976-7647</a><br>
<small>
Sapienza, University of Rome. P.le Aldo Moro 5, 00185 Rome, Italy
</small></p></li>
<li><p><strong>Yoan Paillet</strong> <br>
<img src="images/orcid.svg" class="inline_icon" alt="ORCID icon" />
<a href="https://orcid.org/0000-0001-7232-7844">0000-0001-7232-7844</a><br>
<small>
Irstea, UR EFNO, Domaine des Barres, 45290 Nogent sur Vernisson, France
</small></p></li>
<li><p><strong>Peter Ódor</strong> <br>
<img src="images/orcid.svg" class="inline_icon" alt="ORCID icon" />
<a href="https://orcid.org/0000-0003-1729-8897">0000-0003-1729-8897</a><br>
<small>
MTA Centre for Ecological Research, Institute of Ecology and Botany, H-2163 Vácrátót, Alkotmány u. 2-4., Hungary
</small></p></li>
<li><p><strong>Christophe Bouget</strong> <br>
<img src="images/orcid.svg" class="inline_icon" alt="ORCID icon" />
<a href="https://orcid.org/0000-0002-5206-7560">0000-0002-5206-7560</a><br>
<small>
Irstea, UR EFNO, Domaine des Barres, 45290 Nogent sur Vernisson, France
</small></p></li>
<li><p><strong>Thomas Campagnaro</strong> <br>
<img src="images/orcid.svg" class="inline_icon" alt="ORCID icon" />
<a href="https://orcid.org/0000-0002-6307-6892">0000-0002-6307-6892</a><br>
<small>
Department of Land, Environment, Agriculture and Forestry, Università degli Studi di Padova, I-35020 Legnaro (PD), Italy
</small></p></li>
<li><p><strong>Frédéric Gosselin</strong> <br>
<img src="images/orcid.svg" class="inline_icon" alt="ORCID icon" />
<a href="https://orcid.org/0000-0003-3737-106X">0000-0003-3737-106X</a><br>
<small>
Irstea, UR EFNO, Domaine des Barres, 45290 Nogent sur Vernisson, France
</small></p></li>
<li><p><strong>Philippe Janssen</strong> <br>
<img src="images/orcid.svg" class="inline_icon" alt="ORCID icon" />
<a href="https://orcid.org/0000-0003-3310-0078">0000-0003-3310-0078</a><br>
<small>
Université Grenoble-Alpes, Irstea, UR LESSEM, 2 rue de la Papeterie BP 76, 38402 Saint-Martin-d’Hères, France
</small></p></li>
<li><p><strong>Walter Mattioli</strong> <br>
<img src="images/orcid.svg" class="inline_icon" alt="ORCID icon" />
<a href="https://orcid.org/0000-0003-2107-1038">0000-0003-2107-1038</a><br>
<small>
Council for Agricultural Research and Economics, Research Centre for Forestry and Wood (CREA-FL), v.le Santa Margherita 80, I-52100 Arezzo (AR), Italy
</small></p></li>
<li><p><strong>Juri Nascimbene</strong> <br>
<img src="images/orcid.svg" class="inline_icon" alt="ORCID icon" />
<a href="https://orcid.org/0000-0002-9174-654X">0000-0002-9174-654X</a><br>
<small>
University of Bologna, Department of Biological, Geological and Environmental Sciences, via Irnerio 42, 40126 Bologna
</small></p></li>
<li><p><strong>Tommaso Sitzia</strong> <br>
<img src="images/orcid.svg" class="inline_icon" alt="ORCID icon" />
<a href="https://orcid.org/0000-0001-6221-4256">0000-0001-6221-4256</a><br>
<small>
Department of Land, Environment, Agriculture and Forestry, Università degli Studi di Padova, I-35020 Legnaro (PD), Italy
</small></p></li>
<li><p><strong>Tobias Kuemmerle</strong> <br>
<img src="images/orcid.svg" class="inline_icon" alt="ORCID icon" />
<a href="https://orcid.org/0000-0002-9775-142X">0000-0002-9775-142X</a><br>
<small>
Geography Department, Humboldt-Universität zu Berlin. Unter den Linden 6, 10099 Berlin, Germany; Integrative Research Institute for Human Environment Transformation (IRI THESys), Humboldt-Universität zu Berlin. Unter den Linden 6, 10099 Berlin, Germany
</small></p></li>
<li><p><strong>Sabina Burrascano</strong> <br>
<img src="images/orcid.svg" class="inline_icon" alt="ORCID icon" />
<a href="https://orcid.org/0000-0002-6537-3313">0000-0002-6537-3313</a><br>
<small>
Sapienza, University of Rome. P.le Aldo Moro 5, 00185 Rome, Italy
</small></p></li>
</ul>
<div id="correspondence">
<p>✉ — correspondence preferred via <a href="https://github.com/fmsabatini/TestManubot/issues">GitHub Issues</a>.
Otherwise, address correspondence to <a href="mailto:francesco.sabatini@botanik.uni-halle.de" class="email">francesco.sabatini@botanik.uni-halle.de</a>.</p>
</div>
<h2 class="page_break_before" id="abstract">Abstract</h2>
<p>Policies to mitigate climate change and biodiversity loss often assume that protecting carbon-rich forests provides co-benefits in terms of biodiversity, due to the spatial congruence of carbon stocks and biodiversity at biogeographic scales. However, it remains unclear whether this holds at the scales relevant for management, with particularly large knowledge gaps for temperate forests and for taxa other than trees. We built a comprehensive dataset of Central European temperate forest structure and multi-taxonomic diversity (beetles, birds, bryophytes, fungi, lichens, and plants) across 352 plots. We used Boosted Regression Trees to assess the relationship between above-ground live carbon stocks and (a) taxon-specific richness, (b) a unified multidiversity index. We used Threshold Indicator Taxa ANalysis to explore individual species’ responses to changing above-ground carbon stocks and to detect change-points in species composition along the carbon-stock gradient. Our results reveal an overall weak and highly variable relationship between richness and carbon stock at the stand scale, both for individual taxonomic groups and for multidiversity. Similarly, the proportion of win-win and trade-off species (i.e. species favored or disadvantaged by increasing carbon stock, respectively) varied substantially across taxa. Win-win species gradually replaced trade-off species with increasing carbon, without clear thresholds along the above-ground carbon gradient, suggesting that community-level surrogates (e.g. richness) might fail to detect critical changes in biodiversity. Collectively, our analyses highlight that leveraging co-benefits between carbon and biodiversity in temperate forest may require stand-scale management that prioritizes either biodiversity or carbon-in order to maximize co-benefits at broader scales. Importantly, this contrasts with tropical forests, where climate and biodiversity objectives can be integrated at the stand-scale, thus highlighting the need for context-specificity when managing for multiple objectives. Accounting for critical change-points of target taxa can help to deliver this specificity, by defining a safe operating space to manipulate carbon while avoiding biodiversity losses.</p>
<h2 id="introduction">Introduction</h2>
<p>Forests play a critical role in mitigating climate change,
in addition to providing many ecosystem services fundamental to human society
(FAO, 2015; MEA, 2005).
The estimated amount of carbon stored in forests globally is almost 900 Pg (=1015 g),
with a net global carbon sink of 1.1 Pg C per year
(Pan et al., 2011).
Forests also provide habitat for over half of all known terrestrial plant and animal species (MEA, 2005),
albeit covering only 27% of the Earth’s land area (FAO, 2015).
Conserving forests and managing them sustainably is therefore fundamental
for facing two of the most pressing societal challenges of our times:
biodiversity loss and climate change (MEA, 2005).
Forests play a critical role in mitigating climate change, in addition to providing many ecosystem services fundamental to human society (FAO, 2015; MEA, 2005). The estimated amount of carbon stored in forests globally is almost 900 Pg (=1015 g), with a net global carbon sink of 1.1 Pg C per year (Pan et al., 2011). Forests also provide habitat for over half of all known terrestrial plant and animal species (MEA, 2005), albeit covering only 27% of the Earth’s land area (FAO, 2015). Conserving forests and managing them sustainably is therefore fundamental for facing two of the most pressing societal challenges of our times: biodiversity loss and climate change (MEA, 2005).</p>
<p>Global and regional environmental policies, such as the 2015 Paris Agreement, the REDD+ (Reducing Emissions from Deforestation and forest Degradation) initiative (Gardner et al., 2012) or the European Forest Strategy (European Commission, 2013), all acknowledge the critical importance of forests for jointly addressing biodiversity conservation and climate change mitigation (Bustamante et al., 2016; Deere et al., 2018; Ferreira et al., 2018). The extent to which these two targets can be reached synergistically, however, is not properly understood (Di Marco, Watson, Currie, Possingham, &amp; Venter, 2018; Mori, Lertzman, &amp; Gustafsson, 2017; Pichancourt, Firn, Chadès, &amp; Martin, 2014). If high biodiversity and carbon stocks coincide spatially, then protecting carbon-dense forests or managing forests for high carbon stocks would co-benefit both environmental policy goals (Di Marco et al., 2018; Reside, VanDerWal, &amp; Moran, 2017; Strassburg et al., 2010). Otherwise, this may lead to negative biodiversity outcomes (<span class="citation" data-cites="1D7o4Q61q"><a href="#ref-1D7o4Q61q" role="doc-biblioref">1</a></span>; Bustamante et al., 2016; Ferreira et al., 2018). For instance, protecting a carbon-dense forest may reallocate human pressure to unprotected areas with lower carbon density, but high biodiversity (Di Marco et al., 2018). Also, shifting from natural vegetation to tree plantations to maximise carbon stock leads to biodiversity loss (Pichancourt et al., 2014), especially where natural grasslands or savannahs are afforested (<span class="citation" data-cites="12qlbeGhM"><a href="#ref-12qlbeGhM" role="doc-biblioref">2</a></span>; Burrascano et al., 2016; Pellegrini, Socolar, Elsen, &amp; Giam, 2016). Finally, it remains unclear at which spatial scales co-benefits between conservation and climate-change-mitigation should be sought. More than grain (i.e., spatial resolution), extent (i.e., area covered) is in this context particularly relevant. Should carbon storage and conservation goals be integrated at the extent of individual stands (i.e. individual silvicultural units where management takes place), or at broader scales (e.g., entire landscapes or ecoregions)? Should co-benefits be achieved by managing individual stands to maximize both objectives, or by segregating stands dedicated to biodiversity from those dedicated to carbon storage within a landscape? Understanding the relationship between carbon stocks and biodiversity, and how it varies across spatial scales, is crucial to answer these questions (Gardner et al., 2012; Mori et al., 2017; Reside et al., 2017).</p>
<p>At the extent of an individual forest stand, carbon stock is the amount of long-term carbon stored in living biomass, dead organic matter and soil carbon pools, and is the result of the complex relationships between forest productivity, disturbance history, and species composition (FAO, 2015). Compared to other important forest carbon pools, above-ground live carbon stored in wood (hereafter above-ground live carbon) can be quantified relatively easily, and is therefore considered a sustainable forest management indicator (CBD, 2006; FOREST EUROPE, 2015). Even if living and dead wood constitute the substrate for many forest species (Hatanaka, Wright, Loyn, &amp; Mac Nally, 2011; Lassauce, Paillet, Jactel, &amp; Bouget, 2011; Stokland, Siitonen, &amp; Jonsson, 2012), the carbon contained in these forest features is only indirectly related to biodiversity (Hatanaka et al., 2011). Typically based on coarse-grained data, recent evidence supports a positive correlation between above-ground live carbon and biodiversity at broader extents (Di Marco et al., 2018; Lecina‐Diaz et al., 2018; Strassburg et al., 2010). The shape of the carbon-biodiversity relationship, however, remains unclear for smaller extents such as individual landscapes or stands (Ferreira et al., 2018; Pichancourt et al., 2014). Yet, these extents are the most relevant for decision-makers (Deere et al., 2018).</p>
<p>Large uncertainties also remain on how this relationship varies across biogeographical regions (Di Marco et al., 2018; Lecina‐Diaz et al., 2018; Potter &amp; Woodall, 2014; Xian et al., 2015). For the tropics, there is evidence for a positive relationship between biodiversity and above-ground live carbon stocks, both across stands (Cavanaugh et al., 2014; Deere et al., 2018; Magnago et al., 2015), and within stands (Sullivan et al., 2017), especially for disturbed sites (Ferreira et al., 2018). In temperate forests, research has traditionally focused on carbon sequestration and productivity (Ratcliffe et al., 2017, Huang et al., 2018). Although recent work highlighted the importance of carbon quality, or complexity, for bird biodiversity (Hatanaka et al., 2011; Lecina‐Diaz et al., 2018), studies relating carbon quantity to biodiversity remain rare and mostly refer to tree diversity only (Potter &amp; Woodall, 2014; Xian et al., 2015).</p>
<p>The carbon-biodiversity relationship may also vary across taxonomic groups (Di Marco et al., 2018; Ferreira et al., 2018; Lecina‐Diaz et al., 2018). Even in the tropics most research to date has focused on either vertebrates (<span class="citation" data-cites="XcsCFRrv"><a href="#ref-XcsCFRrv" role="doc-biblioref">3</a></span>; Deere et al., 2018; Sollmann et al., 2017), or tree species richness only (Cavanaugh et al., 2014; Magnago et al., 2015; Sullivan et al., 2017), while research comparing the fine-scale carbon-biodiversity relationship across groups of organisms remains rare (Ferreira et al., 2018). This is understandable, given the inherent costs of collecting field-based data for multiple taxonomic groups (Bustamante et al., 2016). Focusing on trees or vertebrates, however, assumes that these taxa are good surrogates for overall forest biodiversity (Lecina‐Diaz et al., 2018), while recent evidence suggests that this is not generally true (Larrieu et al., 2018; Sabatini et al., 2016; Zilliox &amp; Gosselin, 2014). Moreover, even within the same taxonomic group, different species may relate very differently to carbon stocks (Edwards et al., 2014; Lindenmayer, Fischer, &amp; Cunningham, 2005; Villard &amp; Jonsson, 2009). Some species may benefit from increasing carbon stocks (hereinafter called ‘win-win species’), while others, hereafter ‘trade-off species’, may be hindered by the environmental conditions associated to carbon-dense forests (Ferreira et al., 2018). Splitting the community into win-win and trade-off species, and considering explicitly the behaviour of species of conservation concern, could thus help to better predict the effect of changing carbon stock on specific components of biodiversity (Magnago et al., 2015; Sollmann et al., 2017).</p>
<p>Finally, although the carbon-biodiversity relationship is often assumed to be linear (<span class="citation" data-cites="XcsCFRrv"><a href="#ref-XcsCFRrv" role="doc-biblioref">3</a></span>; Deere et al., 2018; Sullivan et al., 2017), thresholds could exist along the carbon stock gradient, meaning that a slight change in forest carbon stocks could cause disproportionate biodiversity loss (Evans et al., 2017; Sasaki, Furukawa, Iwasaki, Seto, &amp; Mori, 2015). Such thresholds have been identified for a range of anthropogenic gradients (Li, Xu, Zheng, Taube, &amp; Bai, 2017; Magnago et al., 2015; Sasaki et al., 2015), including carbon stocks in tropical forests (Ferreira et al., 2018). For temperate forests, however, empirical evidence is lacking (Evans et al., 2017), especially at stand-scale (Sasaki et al., 2015). Identifying such thresholds, and understanding how they vary across taxa and forest types, would provide important information on how forest management, including timber harvesting, might impact biodiversity. This would help to identify ‘safe operating spaces’ for manipulating forest carbon in managed forests without triggering undesired biodiversity loss (Villard &amp; Jonsson, 2009).</p>
<p>Here, we investigated the relationships between the diversity of six ecological groups (i.e., saproxylic beetles, birds, bryophytes, wood-inhabiting fungi, epiphytic lichens, and vascular plants) and carbon stock across 22 temperate forest sites in three European countries. We addressed the following questions:
1) What is the relationship between above-ground live carbon stocks and (a) species richness of different taxa, and (b) a single, unified multidiversity index?
2) How do responses to increasing above-ground live carbon of individual species, and the proportion of win-win and trade-off species, vary across taxonomic groups and forest types?
3) Are there community level thresholds in species richness or composition along carbon stock gradients?</p>
<h2 id="materials-and-methods">Materials and methods</h2>
<h3 id="study-sites">Study sites</h3>
<p>Our study area included a network of 352 plots in 22 temperate forest sites (ranging from 200 to 400 km2), sampled in six different projects (<span class="citation" data-cites="Xfu2maU3"><a href="#ref-Xfu2maU3" role="doc-biblioref">4</a></span>), and covering a wide latitudinal and longitudinal range across Europe (Figure <a href="#fig:Figure1">1</a>, Table ??).</p>
<div id="fig:Figure1" class="fignos">
<figure>
<img src="images/Fig1.map.scatterpie_mercator.jit8.png" alt="" /><figcaption><span>Figure 1:</span> Figure 1 – Distribution of forest sites in Europe. Pie charts report the relative proportion of plots in different forest types (FTs) for each site. FTs follow EEA (2006). The size of the pie represents the number of plots in each site. Grey shadings represent the distribution of forest in Europe. FT4 - acidophilous oak and oak-birch forest; FT5 - mesophytic deciduous forest; FT6 - European beech (Fagus sylvatica) and (FT7) montane beech forest; FT8 - thermophilous deciduos forest.</figcaption>
</figure>
</div>
<p>The sites covered deciduous forest types that are common in temperate Europe, including acidophilous oak and oak-birch forests (20 plots), mesophytic deciduous forests (84 plots), European beech (Fagus sylvatica) and montane beech forests (232 plots in total), as well as thermophilous deciduos forests (16 plots). Forest type nomenclature follows EEA (2006). Although our dataset cannot be considered representative of the overall variability of these forest types, it covers a wide range of structural types (one-, two- and multi-layered stands), ages, management histories, and management regimes, including coppice, shelterwood, group selection and unmanaged stands, comprising late-successional phases of the forest succession gradient. Stands in the Hungarian dataset represent a gradient in tree species composition, from oak- to beech-dominated forest, but all sharing similar age (mature, between 70-120 yr), and mesic conditions. The datasets in the Italian and French Alps contrast pairs of managed and unmanaged stands in similar growing conditions, as well as ancient and recent forests (i.e. resulting from afforestation of previous pastures and meadows). Forest stands in the Cilento National Park were selected as a representative subset of the most common forest types in the park area, while those in the Gran Sasso National Parks spanned across a range of structural types but all belonged to beech-dominated forest types prioritised for conservation. We report summary statistics of the main structural characteristics for each forest site in Table S2 and show the distribution of silvicultural systems across sites in Figure S1.<br />
Elevation ranged from 150 to 1700 m a.s.l. and substrates included sedimentary rocks (limestones, dolomites, marls, and flysch) in the French and Italian sites, and alluvial gravel mixed with sand and loess in the Hungarian site. All sites belonged to the temperate region: annual mean temperature varied from 5°C in the French Alps to 14°C in southern Italy. Annual precipitation varied from about 600 mm to about 1900 mm.</p>
<h3 id="sampling-and-measuring-biodiversity">Sampling and measuring biodiversity</h3>
<p>Multi-taxonomic data was collected in the six different projects (Burrascano et al., 2018) using comparable, but not identical sampling protocols (Table S3 in the Supplementary Material for details). All vascular plant species were recorded in plots ranging from 314 to 1,256 m2. Bryophytes were sampled on different substrates (standing trees, deadwood, rocks, and ground) while only epiphytic lichens and wood-inhabiting fungi were considered. Birds were sampled using point-counts or area search techniques. Saproxylic beetles were sampled using window-flight interception traps, emerging traps and Winkler extractors. Only presence-absence data was available for birds, bryophytes, fungi and lichens, while abundance data was available for plants (percentage cover) and beetles (number of trapped individuals). Not all six taxonomic groups were sampled in every plot, returning a total of 1,533 (= taxonomic group x plot) combinations. We fixed nomenclature inconsistencies in the species lists based on up-to-date checklists (Table S3). We derived the association of species to forest or open habitat for 802 out of 1102 (72%) of birds, bryophytes, lichens and plants from IUCN (2018) and Schmidt, Kriebitzsch &amp; Ewald (2011).
To control for varying sampling efforts across sites, we calculated for each plot the scaled richness of each taxonomic group, i.e. the ratio between the richness observed in the plot (alpha diversity) and the species pool size of that taxonomic group in a given site. Species pool size was estimated as the asymptotic species richness based on sample-based rarefaction and extrapolation curves (Colwell et al., 2012) using the Chao2 estimator in the R package iNext (Hsieh, Ma, &amp; Chao, 2016). This approach also returns a measure of sampling completeness, which we compared across sites and taxonomic groups. We then calculated the average scaled richness across taxonomic groups to obtain a single measure of the diversity of all taxa we sampled, hereafter referred to as multidiversity (<span class="citation" data-cites="dTSwQax6"><a href="#ref-dTSwQax6" role="doc-biblioref">5</a></span>). Multidiversity ranges between 0 and 1, with multidiversity of 1 meaning that a plot hosts all species contained in the species pool of a site. Multidiversity has the advantage of being comparable across sites, whatever the sampling effort and the species pool (both at the taxa and the site levels). To assess the robustness of our results to this scaling procedure, we also ran the analyses after scaling the species richness of a taxonomic group in a plot by the total number of species observed (rather than estimated via extrapolation curves) in the corresponding site for that taxonomic group. Neither of the two approaches are perfect, but provide complementary information. While the first approach allows controlling for the varying number of sampling units across sites, the second controls for differences in sampling design not related to sampling size (e.g. plot area).</p>
<h2 id="forest-above-ground-live-carbon">Forest above-ground live carbon</h2>
<p>Sampling of forest structure is described in detail in Burrascano, Sabatini &amp; Blasi, (2011), Janssen et al., (2017), Márialigeti et al., (2016), Paillet et al., (2015), Sabatini et al., (2016), and Sitzia et al., (2012), and synthesized in Table S3. In short, we sampled living trees in plots ranging from 491 and 2,827 m2 in area using a diameter at breast height (DBH) threshold of 10 cm. Height was measured for all the trees or in a sample of them and calculated successively for the others by means of height-diameter log-log models:
log(h) = b0 + b1 · log(DBH)
where h is the tree height, and b0 and b1 are coefficients obtained empirically for each species in each forest site. We calculated growing stock (GS, m3/ha) as the sum of the individual volumes of the trees measured in a plot, scaled to a per hectare basis. Tree volumes were estimated using regionally calibrated species-specific allometric equations, with DBH and height as explanatory variables. Specifically, we referred to Tabacchi et al. (2011), and Castellani et al. (1984) for the Italian datasets, Sopp &amp; Kolozs (2000) for Hungary, and Algan (1894) for France (Table S3). Growing stock was then converted to above-ground live carbon (AGC, MgC/ha) as AGC = GS<em>BEF</em>WBD/2, where BEFs are biomass expansion factors and WBDs (g/m3) are the wood basic densities (see Table 2 in Federici, Vitullo, Tulipano, De Lauretis, &amp; Seufert, 2008).</p>
<h2 id="control-variables">Control variables</h2>
<p>Coarse woody debris was sampled in plots ranging from 491 to 1,600 m2 using a diameter threshold of 10 cm. Volume of deadwood pieces were either calculated using the same allometric equations used for living trees (for standing or downed dead trees), or approximating deadwood volume to truncated cones or cylinders, depending on the data source (Table S3). Since deadwood represents an important resource for many wood-inhabiting fungi and beetles (Lassauce et al., 2011; Stokland et al., 2012), we included the ratio between deadwood volume and total live and dead wood volumes as a control variable. As additional control variables, we derived two topographic covariates (slope, aspect) from a 30-m resolution Digital Terrain Model (NASA, 2006), which we then used to calculate heat load, i.e. the heat gain from incoming solar radiation. Moreover, for each plot, we extracted the value of the 19 bioclimatic variables contained in WorldClim v2.0 (Fick &amp; Hijmans, 2017), based on a 30 arcsec raster resolution (approx. 1 km). To avoid multicollinearity, we ran a Principal Component (PC) analysis, and then considered the first four PCs, which collectively accounted for 93.5% of total variation. After passively projecting the 19 Bioclimatic variables onto the PC space (function envfit, in the R package vegan), we interpreted PC1 as a gradient of temperature, PC2 as gradient of seasonality, PC3, as a gradient of isothermality and PC4 as a gradient of Mediterranean influence (from winter rain to summer rain; Table S4). We derived information on parent material from the European Digital Archive on Soil Maps to classify plots into three classes: igneous-metamorphic, sedimentary-clastic, sedimentary-limestone (Panagos, Jones, Bosco, &amp; Kumar, 2011). Finally, we considered forest type as a categorical variable with four levels: acidophilous oak, mesophytic deciduous, beech dominated, and thermophilous deciduous. As we lacked detailed information on past forest management, we assigned each plot to one of four broad silvicultural systems: shelterwood, coppice with standards, tree/group selection, or unmanaged (at least since 20 years).
Modelling the response of biodiversity to forest above-ground C
We used Boosted Regression Trees (BRTs) to assess the relationship between above-ground live carbon and the scaled species richness of each taxonomic group as well as multidiversity. BRTs are non-parametric models based on decision trees in a boosting framework that does not require prior assumptions. BRTs are therefore relatively robust against overfitting, missing data, and collinearity (Elith, Leathwick, &amp; Hastie, 2008). We used above-ground live carbon as explanatory variable, while controlling for the effect of forest structure, silvicultural system, climate, topography and soil. After checking for collinearity (Pearson’s r&gt;0.7), we retained nine control variables: coarse woody debris ratio, forest type, silvicultural system, bioclimate (four PCs), heat load and substrate parent material. We also included forest site and data source (Table S1), as categorical control variables to account for remaining unobserved environmental and methodological differences across sites.
We parametrized the BRTs setting a tree complexity of 5 and a bag fraction of 0.5 (Elith et al., 2008). We tested different learning rates (0.5 - 0.001), and determined the optimal number of trees for each learning rate using the gbm.step routine provided in the dismo package (Hijmans, Phillips, Leathwick, &amp; Elith, 2011). We then selected the parameter combination returning the highest cross-validated model fit. We finally calculated the relative importance of each explanatory variable (i.e., the fraction of times a variable was selected for splitting a tree in each BRT model, weighted by the squared model improvement). We evaluated model performance using 10-fold cross-validation. We explored the relationship between biodiversity and the explanatory variables using partial dependency plots, which are the graphical visualizations of the marginal effect of a given explanatory variable on scaled richness (or multidiversity). These plots also allow to visually check for non-linear responses and possible thresholds. We explored the interactions between explanatory variables using the gbm.interactions function in the dismo package. Finally, we tested whether the relationship between carbon and biodiversity changes when considering forest and non-forest species separately. All analysis were performed in R 3.4.1.</p>
<h2 id="assessment-of-win-win-and-trade-offs-species">Assessment of win-win and trade-offs species</h2>
<p>We used Threshold Indicator Taxa Analysis – TITAN (<span class="citation" data-cites="LDmAPxgx"><a href="#ref-LDmAPxgx" role="doc-biblioref">6</a></span>) to identify win-win and trade-off species, i.e. species that respectively increase or decrease their abundance and/or frequency with increasing levels of above-ground live carbon. TITAN uses binary partitioning by indicator value (IndVal, Dufrêne &amp; Legendre, 1997) to identify species-specific change-points along an environmental gradient (above-ground live carbon in our case). Change-points are compared to random data permutations to assess their relevance, taking into account indices of purity (i.e. proportion of bootstrapped change-points response that agree with the observed response) and reliability (i.e. proportion of bootstrapped change points with significant IndVal for p&lt;0.05). We evaluated uncertainty in change-point location based on the bootstrapped empirical distribution (<span class="citation" data-cites="LDmAPxgx"><a href="#ref-LDmAPxgx" role="doc-biblioref">6</a></span>). To account for the nested (plots within sites) and unbalanced (different number of plots per site) nature of our dataset, we modified TITAN’s original bootstrapping approach to randomly select (with replacement) a number of plots per site equal to the number of plots in the site having the lowest number of plots (if greater than 3, 3 otherwise). We ran TITAN after pooling all species across taxonomic groups, but separately for forest types. We aggregated acidophilous and mesophytic oak forests (oak-dominated thereafter), and lowland and montane beech forests (beech-dominated forest thereafter) but excluded termophilous oak forests due to the low sample size (n = 16). We also checked the conservation status of our win-win or trade-off species using the IUCN red lists (IUCN, 2018) and the r package rredlist (version 4.0, Chamberlain, 2017).
TITAN also allows exploring if species-level change points aggregate to a community-level threshold, i.e. congruent change-points across all individual species, which we did separately for trade-off and win-win species. To explore the variability across taxonomic groups in community-level change-points, we ran TITAN both when considering the whole species assemblage, and for each taxonomic group. We considered narrow confidence limits across bootstrapped replicates as an evidence for a community threshold.</p>
<h2 id="results">Results</h2>
<h3 id="relationships-between-above-ground-live-carbon-and-species-richness">Relationships between above-ground live carbon and species richness</h3>
<p>We inventoried a total of 2,384 species: 79 species of birds, 178 lichens, 230 bryophytes, 615 plants, 620 fungi and 693 saproxylic beetles. The average number of species per plot was 94.9 ± 30.8 (standard deviation) species, and ranged between 11.3 ± 4.16 for birds and 34 ± 13.4 for plants. The estimated number of species per site ranged from 34.8 ± 14 for birds to 148 ± 47.7 for plants. Sample-based rarefaction and extrapolation curves showed that our sampling was on average very complete (Figure S2): the median sampling completeness was 92% (Table S5).
The relationship between scaled richness and above-ground live carbon was overall consistently weak (relative importance between 2.7-8.1%, Figures S3-S4), and varied in direction across taxa (Figure <a href="#fig:Figure2">2</a>). The scaled richness of birds, bryophytes and fungi increased slightly, but non-linearly, across the above-ground live carbon gradient (~5% absolute increase along the whole gradient). Most of the increase for birds and bryophytes occurred between 180-200 MgC/ha and 120-150 MgC/ha, respectively. The richness fraction of fungi increased non-monotonically along the above-ground live carbon gradient, with a first peak at 70 MgC/ha, and a secondary peak at 175 MgC/ha. The richness fraction of plants, instead, showed a ~5% absolute decline (see also Figures S5-S10).</p>
<div id="fig:Figure2" class="fignos">
<figure>
<img src="images/Fig2_pdp_1_compareAGC_20180927_final.png" alt="" /><figcaption><span>Figure 2:</span> Partial dependency plots of the relationship between scaled richness and above-ground live carbon, modelled using Boosted Regression Trees. Scaled richness represents the fraction of species of the species pool size estimated for a given plot. Ticks on the x-axis represent above-ground live carbon data distribution. For each taxonomic group, we report in parenthesis the relative importance of above-ground live carbon in the respective boosted regression tree model.</figcaption>
</figure>
</div>
<p>Above-ground live carbon had a very little relative importance on multidiversity (1.9%), compared to other control variables especially site (relative importance 78.2% - Figure S11). Multidiversity increased by less than 1% over the whole above-ground live carbon gradient (Figure <a href="#fig:Figure3">3</a>). BRT models were effective at modelling multidiversity and scaled richness (cross-validated correlation 0.54-0.84, Table S6), although most of the variation derived from site-to-site differences. Indeed, site was always the variable having the highest relative importance, across all taxonomic groups (49.6-79.4%, Figure S4). Coarse woody debris ratio ranked as second best variable for beetles, bryophytes, fungi and multidiversity (relative importance of 5.9%, 9.4%, 8.5% and 5.3%, respectively). Bioclimate was a good predictor of lichen diversity, especially PC4 – Mediterranean influence (relative importance 10.1%) and PC1 – temperature (8%)(FigureS4). For all taxa but beetles and lichens, the interaction between site and above-ground live carbon ranked among the top three most important interactions.</p>
<div id="fig:Figure3" class="fignos">
<figure>
<img src="images/Fig3_pdp_AGC_1_multidiversity_20180927.png" style="width:4in" alt="" /><figcaption><span>Figure 3:</span> Partial dependency plot of the relationship between multidiversity and above-ground live carbon using Boosted Regression Trees. Multidiversity represents the average of the scaled richness of different taxonomic groups, when this was scaled on the estimated species pool size of the respective taxonomic group in the forest site. Tick marks on the x-axis represent above-ground live carbon data distribution. The relative importance of above-ground carbon as an explanatory variable for multidiversity is 1.9%.</figcaption>
</figure>
</div>
<p>These results were relatively robust to the scaling criteria used. When scaling richness by the number of species observed in the respective site (rather than estimated), the results were qualitatively similar, although the cross-validated correlation was consistently lower, especially for lichens (Figure S12-S14, Table S7). Also when considering forest and non-forest species separately, the predictive ability of above-ground carbon remained limited, and ranged between 2.4% (birds) and 6.6% (plants) for forest species, and between 3.8% (birds) and 10.9% (plants) for non-forest species (Figure S15, Table S8-S9). Still, we observed a much stronger increase in forest species richness of lichens for increasing carbon, while the response of birds, bryophytes, plants and multidiversity remained qualitatively similar to what observed for the full data (Figure S16-S19).</p>
<h3 id="response-of-individual-species-to-changes-in-above-ground-carbon">Response of individual species to changes in above ground carbon</h3>
<p>The TITAN analyses identified 27 and 75 species as pure and reliable indicators of above-ground live carbon (i.e. having a consistent response in both direction and magnitude across bootstrap replicates), in oak- and beech-dominated forests, respectively, corresponding to 5.3% and 9.0% of the total number of species (Figure <a href="#fig:Figure4">4</a>). Most of the species-specific change-points occurred between 80-120 MgC/ha, in both forest types (Figure S20-S21). Eleven species (ten plants and one bryophyte) were pure and reliable indicators in both forest types. All pure and reliable trade-off indicator species for oak-dominated forests were plants (Figure S20), either tree species with good dispersal ability (e.g., Sorbus aria, S. domestica, Acer campestre) or herbs and shrubs associated to forest margins (e.g., Vicia sepium, Lonicera xylosteum, Rosa arvensis). Win-win species were mostly bryophytes, typically found in shaded conditions and, secondarily, beetles (Tomicus piniperda, Cryptolestes duplicatus). Trade-off species in beech forests were principally plants (22 species), beetles (16 species) and secondarily birds (three species) and fungi (one species, Figure S21). Win-win species were mostly plants (14 species) and beetles (11 species). Those associated to the right end of the above-ground C gradient were mostly fungi (Fuscoporia ferruginosa, Stereum rugosum and Heterobasidion annosum) and beetles (e.g., Pediacus dermestoides, and Xylechinus pilosus).
Out of the 65 indicator species for which we had information on habitat preference, 37 were forest species (12 win-win and 25 trade-off), and 28 were non-forest species (8 win-win and 20 trade-off; Table S10). Only 200 out of the 2,384 species we considered were included in the IUCN database, with conservation status of win-win and trade-off species only available for 18 species, none of which was threatened.
We found a slightly higher number of trade-off than win-win species, both in oak (3.4 vs. 2%) and in beech (4.7% vs. 4.3%, respectively - Figure <a href="#fig:Figure4">4</a>c). When also considering species not having a reliable response (i.e. responding consistently across bootstraps, but being significant indicators at the p&lt;0.05 level in less than 95% of bootstraps) this balanced picture did not change (8.7% trade-off vs 7.9% win-win species in oak-dominated forests; 11.3% vs 10.8% in beech dominated forests).
The contribution of individual taxonomic groups varied substantially across forest types. In oak-dominated forests (Figure <a href="#fig:Figure4">4</a>a), fungi, lichens and bryophytes returned a higher proportion of win-win than trade-off species, while for plants, we observed the opposite. In beech forests, most taxonomic groups had a higher proportion of trade-off than win-win species, with the exception of bryophytes and beetles (Figure <a href="#fig:Figure4">4</a>b).</p>
<div id="fig:Figure4" class="fignos">
<figure>
<img src="images/Fig4_WinWin.barplot_20180621.png" style="width:5in" alt="" /><figcaption><span>Figure 4:</span> Proportion of win-win vs. trade-off species across taxonomic groups and forest types (sorted for decreasing number of win-win species). a) oak-dominated forests. b) beech-dominated forests c) comparison of the two forest types across all taxonomic groups. Win-Win<em>(dark blue, left) and trade-off</em> (dark red, right) species are pure and reliable species. Win-win (light blue, left) and trade-off (orange, right) species are pure but not reliable indicators.</figcaption>
</figure>
</div>
<h3 id="community-level-change-points-along-above-ground-live-carbon-gradients">Community level change-points along above-ground live carbon gradients</h3>
<p>Aggregating individual species’ responses to infer community-level change-points did not reveal a clear community-threshold in above-ground live carbon across all the taxa (Figure <a href="#fig:Figure5">5</a>). In oak-dominated forests, the wide confidence intervals around the community-level change-points suggest that rather than abruptly, trade-off species were gradually replaced by win-win species with increasing above-ground live carbon. In beech forests, instead, we observed relatively sharp community-level change-points for trade-off species across all taxa (except lichens), which ranged between 81.3 MgC/ha (fungi) and 122.4 MgC/ha (lichens). In both forest types, community-level change-points of win-win species were more variable than those of trade-off species and, at least in beech forests, returned wider confidence intervals (e.g., for plants, fungi and beetles). Community-level change-points for trade-off species of different taxa were very similar across the two forest types, while for win-win species these were on average higher in beech compared to oak forests.</p>
<div id="fig:Figure5" class="fignos">
<figure>
<img src="images/Fig5.Titan_AllTaxa_Sumz_Comparison_20180709gg.png" style="width:7in" alt="" /><figcaption><span>Figure 5:</span> Community-level change-points and 90% quantiles along the above-ground live carbon gradient for different taxonomic groups, in two forest types. Tick marks on the x-axis represent above-ground live carbon data distribution.</figcaption>
</figure>
</div>
<h2 id="discussion">Discussion</h2>
<p>Can managing forest for carbon storage jointly achieve biodiversity conservation and climate-change mitigation goals? Answering this question critically depends on better understanding the relationship between forest carbon stocks and biodiversity for the scales at which management takes place (Ferreira et al., 2018; Gardner et al., 2012; Mori et al., 2017). We assembled a large dataset of plot-level forest carbon stock and multi-taxonomical diversity for temperate forest, where knowledge gaps are largest. We found little evidence that above-ground live carbon and species richness in temperate forests are congruent at the extent of individual forest stands, which contrasts with most of the evidence from the tropics (Sullivan et al., 2017). For all taxa we investigated, we found that win-win species gradually replaced trade-off species with increasing above-ground live carbon levels, changes that biodiversity surrogates (e.g. richness) would fail to detect. In general, species and community-level change-points were neither congruent, nor equally abrupt across taxa, suggesting that leveraging co-benefits across taxonomic groups might be difficult. Overall, our results highlight that in temperate forests it may not be best to jointly pursue conservation and climate-change-mitigation goals at the extent of forest stands. Rather, forest planners should establish local priorities to leverage potentially higher co-benefits at broader extents. Stand-specific priorities can be established by taking into account the taxon-specific carbon-biodiversity relationship and the share of win-win vs. trade-off species to establish a safe operating space to manipulate above-ground live carbon levels while avoiding undesired biodiversity loss.</p>
<p>Our work provides new insights into the shape, variability and context-specificity of the carbon-biodiversity relationship, especially for taxonomic groups that are rarely considered (e.g., fungi, lichens, saproxylic beetles and bryophytes). The correlation between carbon and biodiversity was overall relatively weak and highly variable across taxonomic groups, and this result was robust when comparing different standardization techniques accounting for data heterogeneity and the unequal sample intensity across sites. While previous research mostly reported that carbon stocks and biodiversity may both benefit from the prioritization of the same set of forest stands a (Deere et al., 2018; Magnago et al., 2015; Reside et al., 2017; Sullivan et al., 2017), for temperate forests the evidence is still inconclusive and mainly based on tree species only (Lecina‐Diaz et al., 2018; Potter &amp; Woodall, 2014; Xian et al., 2015). The contrasting patterns observed across different taxonomic groups, with larger differences than between forest and non-forest species, may explain the weak relationship between multidiversity and above-ground live carbon. On the one hand, carbon-dense, late-successional forests represent better habitat than open forests for many organisms. Birds, for instance, may benefit from high above-ground live carbon, especially in the presence of ecologically complex carbon, such as wide-branching canopies, large standing trees and stem cavities (Paillet et al., 2018; Hatanaka et al., 2011; Lecina‐Diaz et al., 2018). High above-ground live carbon also often correlates with high deadwood levels, which represents fundamental resources for wood-inhabiting fungi or beetles (Lassauce et al., 2011; Stokland et al., 2012). On the other hand, plant species richness decreased with increasing above-ground live carbon stocks, especially when non-forest species were taken into account (Figure S17), likely as a consequence of the strong, asymmetrical competition for light exerted by few tree species on the herb-layer, which comprises the majority of plant species in temperate forests (Sabatini, Jiménez-Alfaro, Burrascano, &amp; Blasi, 2014). Furthermore, in our assessment most variation occurred across forest sites, rather than along the above-ground live carbon gradient. This is in agreement with previous research, which highlighted the importance of broad-scale drivers, including macroclimate and the regional species pool, as determinants of forest fine-scale biodiversity (Jiménez-Alfaro et al., 2018; Sullivan et al., 2017).</p>
<p>Forest assemblage composition did change along the above-ground live carbon gradient, although species richness and multidiversity did not. With increasing above-ground live carbon, win-win species gradually replaced trade-off species, confirming that what constitutes suitable habitat conditions differs among species (Lindenmayer et al., 2005). Both in oak- and beech-dominated forests, the overall proportion of win-win species was similar to the proportion of trade-off species. This might concur at explaining why both multidiversity and scaled richness per taxa were relatively insensitive to increasing above-ground live carbon, since neither can discriminate between colonization and local extinction of species when these occur simultaneously and gradually in response to shifts in ecological conditions (Lindenmayer et al., 2005). As observed in tropical forests, the effect of carbon removal on species richness may be confounded by the increase in generalist species, so that a special focus on sensitive species, or species of conservation concern is recommended (Deere et al., 2018; Magnago et al., 2015). With the exception of plants, we did not find marked increases in non-forest species for the low end of the carbon gradient, possibly because we excluded the earliest successional stages in our analyses. Furthermore, the conservation status of the vast majority (92%) of species was not available, especially for understudied taxa (i.e. lichens, fungi and bryophytes; IUCN, 2017). In the absence of species-level assessments, identifying win-win and trade-off species provides a proxy for identifying sensitive taxa, and for calibrating biodiversity goals when managing temperate forests for climate-change mitigation.</p>
<p>Community-level change-points differed between win-win and trade-off species, as well as across taxa and forest types, suggesting that a clear ecological threshold along the carbon-stock gradient may not exist in temperate forests. When considering trade-off species, however, we found a relatively marked decrease between ~80-120 MgC/ha, and the change-points of different taxonomic groups were surprisingly similar across the two forest types. We interpret this result as the effect of canopy closure (i.e. the phase of forest succession when the canopies of individual trees overlap), which reduces light availability, buffers temperature variation, increases relative humidity, and nearly excludes wind at the forest floor (Franklin et al., 2002). These ecological changes may determine a shift in the species composition of the herb-layer and facilitate forest succession towards the dominance of shade tolerant species, while triggering bottom-up cascading effects on the whole trophic network (Kagata &amp; Ohgushi, 2006). Furthermore, canopy closure kicks off self-thinning processes, which provide a first pulse of deadwood in early successional stands, thus favouring the colonization by saproxylic species (Lassauce et al., 2011; Stokland et al., 2012). This result suggests that a general pattern may exist in temperate forests and advises against assuming a linear positive carbon-biodiversity relationship in conservation actions (Di Marco et al. 2018).</p>
<p>We used a large, multi-taxonomic dataset collected across a broad geographical area and environmental gradient, which give us confidence on the generality of our results. Still, our analyses do not come without uncertainty. First, although comprehensive, our dataset suffers from a lack of detailed information on management and disturbance history, both of which influence biodiversity and carbon stock, and possibly their relationship (Paillet et al., 2010). We accounted for differences in silvicultural systems across plots, but our reconstruction was coarse, and we cannot exclude that legacies of past forest management (e.g. coppicing) may still be playing a role. Second, our results provide indication on the carbon-biodiversity relationship for natural or semi-natural forests only, i.e. self-regenerated forests of native species. These forests are particularly relevant for biodiversity conservation, but in many European countries they are often replaced with forest plantations composed of very productive carbon-sinking species (e.g., Picea abies, Pseudotsuga menziesii, Eucalyptus spp.) that may show different carbon-biodiversity relationships (Pichancourt et al., 2014). Finally, our dataset is heterogeneous and spatially nested in nature. Failing to treat data nestedness can lead to problems of pseudoreplication and higher probabilities of type I error. We accounted for nestedness by stratifying the bootstrapping procedure when exploring change-points through TITAN. This, however, comes at the cost of reducing the power of the analysis, which means that our analysis might not detect all the win-win and trade-off species. Still, our results were robust to different standardization techniques (see Table S6-S7, and Figure S12-S14), which suggests that data heterogeneity did not confound the overall signal we found.</p>
<p>Our work provides new understanding of how co-benefits between biodiversity and carbon storage might be leveraged in temperate forests. Three major implications for management derive from our results. First, biodiversity and above-ground live carbon cannot easily be simultaneously maximized in temperate forests at the extent of individual stands. Instead of seeking to maximize both goals at this extent, co-benefits might be larger for strategies that seek to maximize them across broader extents, for example by segregating areas dedicated to biodiversity from those dedicated to carbon storage (Edwards et al., 2014, Kraus &amp; Krum, 2013). Forest planners and managers should carefully evaluate whether to give priority to biodiversity conservation or other carbon-related goals, since maximizing forest carbon stock at the stand scale (e.g. by altering the number and arrangement of trees via thinning or planting) may only benefit some elements of biodiversity, while being detrimental to others. Importantly, the scaling of trade-offs in temperate forests when increasing the observational extent thus appears to differ fundamentally from tropical forests, at least those under management, where climate and biodiversity objectives may be effectively be integrated at the level of individual stands (Deere et al., 2018; Magnago et al., 2015; Ferreira et al, 2018).</p>
<p>Second, reconciling biodiversity and carbon objectives requires planning across multiple scales. This includes assessments of which arrangement of management types delivers lowest trade-off or highest co-benefits (Law et al., 2017; Reside et al., 2017), while integrating stand-level constraints (Pichancourt et al., 2014). Likewise, planning at the extent of landscapes is needed to ensure heterogeneity in forest developmental stage and structure across stands (Schall et al., 2018), which should include set-asides (<span class="citation" data-cites="ObZGxlg5"><a href="#ref-ObZGxlg5" role="doc-biblioref">7</a></span>; Ferreira et al., 2018; Hatanaka et al., 2011), to ensure that trade-off assessments are robust over time. Encouraging the retention of blocks of undisturbed forest as a conservation priority within managed forests may represent an effective option for reconciling carbon-storage and conservation goals, while incorporating multiple environmental goals in forest management (Edwards et al., 2014). This would allow for the persistence of the full range of both win-win and trade-off species, and therefore maximizing multi-taxonomic diversity while optimizing carbon-stock allocation (Trentanovi, Campagnaro, Rizzi, &amp; Sitzia, 2018).
Third and finally, our study highlights that rather than relying on biodiversity surrogates, only an explicit consideration of all taxa of conservation concern will provide the full picture of how these taxa respond to the manipulation of forest structure and above-ground live carbon stocks in temperate forests (Villard &amp; Jonsson, 2009).</p>
<h2 id="author-contributions">Author contributions</h2>
<p>S.B., T.K. and F.M.S. developed the idea for this research. S.B., C.B., T.C., F.G., P.J., W.M, J.N., P.O., Y.P. and T.S. contributed the species and structural data. S.B., R.B.A. and F.M.S. gathered environmental data and processed the data. F.M.S. conducted the analyses and drafted the manuscript. All the co-authors contributed to writing the manuscript.</p>
<h2 id="acknowledgments">Acknowledgments:</h2>
<p>F.M.S. was funded by the European Union’s Horizon 2020 research and innovation programme under the Marie Skłodowska-Curie, grant agreement No. 658876. Sapienza University of Rome provided the funding for the networking activities that allowed this joint research (Ricerche Universitarie 2015 - prot. C26A15KE2T). Data collected in central and southern Italy derive from the LIFE+ project FAGUS (11/NAT/IT/00135), those relative to Hungary from Hungarian Research Fund (OTKA K79158), Őrség National Park Directorate; for the French Alps funding came from IRSTEA and from the Conseil Général de l’Isère and Bauges Natural Regional Park; data for the rest of France were collected by funding of the French Ministry in charge of Ecology (Convention Cemagref-DEB (MEEDDAT), Action GNB and the program “Biodiversité, Gestion Forestière et Politiques Publiques” (BGF), convention GNB 10-MBGD-BGF-1-CVS-092, no CHORUS 2100 214 651) and the Office National des Forêts (Convention ONF-Cemagref, Action 5, 2008); data for northern Italy was collected with funding provided by the Italian Ministry of Agricultural, Food and Forestry Policies, State Forestry Corps (Project Managers: A. Andrighetti and D. Campedel), research agreement No. 767/ 2008 (TS, Principal Investigator). Above all we wish to thank all the people that collaborated in the fieldwork and in the species identification and that solved nomenclature issues: G. Antonini, M.M. Azzella, H. Brustel, M. Cassol, O. Courtin, M. Dal Cortivo, J. Delnatte, L. Facioni, G. Favier, E. Gatti, G. Gobbo, J. Haran, I. Király, G. Kutszegi, S. Labonne, F. Lakatos, E. Lattanzi, F. Lebagousse, D. Lunghini, Z. Mag, O. Maggi, S. Márialigeti, C. Moliard, B. Németh, T. Noblecourt, B. Nusillard, F. Padovan, F. Parisi, S. Ravera, O. Rose, I. Siller, M. Sommacal, P. Tardif, A. Tilia, F. Tinya, M.Varaschin. We thank the anonymous editor, Moreno Di Marco, and two anonymous reviewers for very valuable comments on a prior manuscript version.</p>
<h2 class="page_break_before" id="references">References</h2>
<!-- Explicitly insert bibliography here -->
<div id="refs" class="references hanging-indent" role="doc-bibliography">
<div id="ref-1D7o4Q61q">
<p>1. <strong>Trade-offs for food production, nature conservation and climate limit the terrestrial carbon dioxide removal potential</strong><br />
Lena R. Boysen, Wolfgang Lucht, Dieter Gerten<br />
<em>Global Change Biology</em> (2017-10) <a href="https://doi.org/ggshr7">https://doi.org/ggshr7</a><br />
DOI: <a href="https://doi.org/10.1111/gcb.13745">10.1111/gcb.13745</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/28464416">28464416</a></p>
</div>
<div id="ref-12qlbeGhM">
<p>2. <strong>Does plantation forestry restore biodiversity or create green deserts? A synthesis of the effects of land-use transitions on plant species richness</strong><br />
Leah L. Bremer, Kathleen A. Farley<br />
<em>Biodiversity and Conservation</em> (2010-11-11) <a href="https://doi.org/fbn39z">https://doi.org/fbn39z</a><br />
DOI: <a href="https://doi.org/10.1007/s10531-010-9936-4">10.1007/s10531-010-9936-4</a></p>
</div>
<div id="ref-XcsCFRrv">
<p>3. <strong>Limited carbon and biodiversity co-benefits for tropical forest mammals and birds</strong><br />
Lydia Beaudrot, Kailin Kroetz, Patricia Alvarez-Loayza, Ieda Amaral, Thomas Breuer, Christine Fletcher, Patrick A. Jansen, David Kenfack, Marcela Guimarães Moreira Lima, Andrew R. Marshall, … Sandy Andelman<br />
<em>Ecological Applications</em> (2016-06) <a href="https://doi.org/f8shtg">https://doi.org/f8shtg</a><br />
DOI: <a href="https://doi.org/10.1890/15-0935">10.1890/15-0935</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/27509751">27509751</a></p>
</div>
<div id="ref-Xfu2maU3">
<p>4. <strong>It’s a long way to the top: Plant species diversity in the transition from managed to old-growth forests</strong><br />
Sabina Burrascano, Francesco Ripullone, Liliana Bernardo, Marco Borghetti, Emanuela Carli, Michele Colangelo, Carmen Gangale, Domenico Gargano, Tiziana Gentilesca, Giuseppe Luzzi, … Carlo Blasi<br />
<em>Journal of Vegetation Science</em> (2018-01) <a href="https://doi.org/gc3zt8">https://doi.org/gc3zt8</a><br />
DOI: <a href="https://doi.org/10.1111/jvs.12588">10.1111/jvs.12588</a></p>
</div>
<div id="ref-dTSwQax6">
<p>5. <strong>Interannual variation in land-use intensity enhances grassland multidiversity</strong><br />
E. Allan, O. Bossdorf, C. F. Dormann, D. Prati, M. M. Gossner, T. Tscharntke, N. Bluthgen, M. Bellach, K. Birkhofer, S. Boch, … M. Fischer<br />
<em>Proceedings of the National Academy of Sciences</em> (2013-12-24) <a href="https://doi.org/f24njq">https://doi.org/f24njq</a><br />
DOI: <a href="https://doi.org/10.1073/pnas.1312213111">10.1073/pnas.1312213111</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/24368852">24368852</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3890898">PMC3890898</a></p>
</div>
<div id="ref-LDmAPxgx">
<p>6. <strong>A new method for detecting and interpreting biodiversity and ecological community thresholds</strong><br />
Matthew E. Baker, Ryan S. King<br />
<em>Methods in Ecology and Evolution</em> (2010-03) <a href="https://doi.org/dz5kp8">https://doi.org/dz5kp8</a><br />
DOI: <a href="https://doi.org/10.1111/j.2041-210x.2009.00007.x">10.1111/j.2041-210x.2009.00007.x</a></p>
</div>
<div id="ref-ObZGxlg5">
<p>7. <strong>Does a set-aside conservation strategy help the restoration of old-growth forest attributes and recolonization by saproxylic beetles?</strong><br />
C. Bouget, G. Parmain, O. Gilg, T. Noblecourt, B. Nusillard, Y. Paillet, C. Pernot, L. Larrieu, F. Gosselin<br />
<em>Animal Conservation</em> (2014-08) <a href="https://doi.org/gfdb7x">https://doi.org/gfdb7x</a><br />
DOI: <a href="https://doi.org/10.1111/acv.12101">10.1111/acv.12101</a></p>
</div>
</div>
<h2 class="page_break_before" id="supplementary-material">Supplementary Material</h2>
<div id="tbl:TableS1" class="tablenos">
<table>
<caption><span>Table S1:</span> Description of study sites. Site in the data source column refer to Table S3. </caption>
<colgroup>
<col style="width: 12%" />
<col style="width: 8%" />
<col style="width: 11%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 6%" />
<col style="width: 7%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="header">
<th>Stand Name</th>
<th>Data source</th>
<th>Substrate</th>
<th>Number of Plots</th>
<th>Annual Mean T °C</th>
<th>Annual rainfall mm</th>
<th>Elevation</th>
<th>Aspect °</th>
<th>Slope °</th>
<th>Latitude</th>
<th>Longitude</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Auberive</td>
<td>FR_YP</td>
<td>Limestone</td>
<td>22</td>
<td>9</td>
<td>800-900</td>
<td>455</td>
<td>229</td>
<td>5</td>
<td>47.749</td>
<td>5.068</td>
</tr>
<tr class="even">
<td>Ballons-Comtois</td>
<td>FR_YP</td>
<td>Granit</td>
<td>14</td>
<td>6.9</td>
<td>1300-1400</td>
<td>1043</td>
<td>189</td>
<td>16</td>
<td>47.818</td>
<td>6.798</td>
</tr>
<tr class="odd">
<td>Bauges</td>
<td>FR_ALPS</td>
<td>Limestone</td>
<td>29</td>
<td>7.2</td>
<td>1350-1850</td>
<td>1107</td>
<td>266</td>
<td>22</td>
<td>45.701</td>
<td>6.167</td>
</tr>
<tr class="even">
<td>Bois du Parc</td>
<td>FR_YP</td>
<td>Limestone</td>
<td>9</td>
<td>10.9</td>
<td>650-750</td>
<td>195</td>
<td>222</td>
<td>4</td>
<td>47.583</td>
<td>3.649</td>
</tr>
<tr class="odd">
<td>Cajada forest</td>
<td>IT_NE</td>
<td>Dolomite/Limestone</td>
<td>9</td>
<td>7.2</td>
<td>1300-1500</td>
<td>1255</td>
<td>141</td>
<td>11</td>
<td>46.235</td>
<td>12.237</td>
</tr>
<tr class="even">
<td>Chartreuse</td>
<td>FR_ALPS</td>
<td>Limestone</td>
<td>31</td>
<td>6.8</td>
<td>1300-1900</td>
<td>1136</td>
<td>245</td>
<td>19</td>
<td>45.339</td>
<td>5.791</td>
</tr>
<tr class="odd">
<td>Chizé</td>
<td>FR_YP</td>
<td>Limestone</td>
<td>18</td>
<td>12</td>
<td>800-900</td>
<td>89</td>
<td>207</td>
<td>2</td>
<td>46.146</td>
<td>-0.386</td>
</tr>
<tr class="even">
<td>Cilento N</td>
<td>IT_FAGUS</td>
<td>Limestone</td>
<td>24</td>
<td>10.1</td>
<td>718-1250</td>
<td>1272</td>
<td>177</td>
<td>17</td>
<td>40.465</td>
<td>15.339</td>
</tr>
<tr class="odd">
<td>Cilento S</td>
<td>IT_CILENTO</td>
<td>Limestone/Flysch</td>
<td>12</td>
<td>11.2</td>
<td>700</td>
<td>1246</td>
<td>175</td>
<td>17</td>
<td>40.257</td>
<td>15.344</td>
</tr>
<tr class="even">
<td>Citeaux</td>
<td>FR_YP</td>
<td>Alluvial deposits</td>
<td>10</td>
<td>10.9</td>
<td>700-800</td>
<td>231</td>
<td>205</td>
<td>2</td>
<td>47.09</td>
<td>5.05</td>
</tr>
<tr class="odd">
<td>Combe Lavaux</td>
<td>FR_YP</td>
<td>Limestone</td>
<td>8</td>
<td>9.1</td>
<td>800-900</td>
<td>572</td>
<td>197</td>
<td>12</td>
<td>47.226</td>
<td>4.939</td>
</tr>
<tr class="even">
<td>Fontainebleau</td>
<td>FR_YP</td>
<td>Acidic sands</td>
<td>25</td>
<td>10.5</td>
<td>600-700</td>
<td>138</td>
<td>172</td>
<td>3</td>
<td>48.421</td>
<td>2.66</td>
</tr>
<tr class="odd">
<td>Gran Sasso</td>
<td>IT_FAGUS</td>
<td>Limestone</td>
<td>19</td>
<td>9.1</td>
<td>1062-1097</td>
<td>1354</td>
<td>263</td>
<td>17</td>
<td>42.508</td>
<td>13.514</td>
</tr>
<tr class="even">
<td>Haut Tuileau</td>
<td>FR_YP</td>
<td>Alluvial deposits</td>
<td>12</td>
<td>10</td>
<td>650-750</td>
<td>175</td>
<td>170</td>
<td>2</td>
<td>48.104</td>
<td>4.188</td>
</tr>
<tr class="odd">
<td>Haute-Chaine du Jura</td>
<td>FR_YP</td>
<td>Limestone</td>
<td>6</td>
<td>7.5</td>
<td>1300-1400</td>
<td>1101</td>
<td>109</td>
<td>25</td>
<td>46.299</td>
<td>5.986</td>
</tr>
<tr class="even">
<td>Lure</td>
<td>FR_YP</td>
<td>Limestone</td>
<td>7</td>
<td>8</td>
<td>1000-1100</td>
<td>1448</td>
<td>109</td>
<td>31</td>
<td>44.123</td>
<td>5.82</td>
</tr>
<tr class="odd">
<td>Orseg</td>
<td>HU</td>
<td>gravel/loess</td>
<td>25</td>
<td>9.2</td>
<td>700-800</td>
<td>308</td>
<td>134</td>
<td>5</td>
<td>46.892</td>
<td>16.308</td>
</tr>
<tr class="even">
<td>Rambouillet</td>
<td>FR_YP</td>
<td>Acidic sands</td>
<td>16</td>
<td>10</td>
<td>600-700</td>
<td>164</td>
<td>180</td>
<td>2</td>
<td>48.671</td>
<td>1.763</td>
</tr>
<tr class="odd">
<td>Val Tovanella</td>
<td>IT_NE</td>
<td>Dolomite/Limestone</td>
<td>11</td>
<td>7.2</td>
<td>1300-1500</td>
<td>1236</td>
<td>306</td>
<td>19</td>
<td>46.309</td>
<td>12.302</td>
</tr>
<tr class="even">
<td>Ventoux</td>
<td>FR_YP</td>
<td>Limestone</td>
<td>9</td>
<td>7.9</td>
<td>1000-1100</td>
<td>1356</td>
<td>187</td>
<td>25</td>
<td>44.181</td>
<td>5.261</td>
</tr>
<tr class="odd">
<td>Ventron</td>
<td>FR_YP</td>
<td>Limestone</td>
<td>3</td>
<td>8.9</td>
<td>1200-1300</td>
<td>956</td>
<td>266</td>
<td>22</td>
<td>47.939</td>
<td>6.931</td>
</tr>
<tr class="even">
<td>Vercors</td>
<td>FR_ALPS</td>
<td>Limestone</td>
<td>18</td>
<td>7</td>
<td>1200-1500</td>
<td>1232</td>
<td>189</td>
<td>15</td>
<td>45.145</td>
<td>5.506</td>
</tr>
<tr class="odd">
<td>Verrières</td>
<td>FR_YP</td>
<td>Acidic sands marls</td>
<td>7</td>
<td>9.6</td>
<td>600-700</td>
<td>177</td>
<td>203</td>
<td>2</td>
<td>48.757</td>
<td>2.25</td>
</tr>
</tbody>
</table>
</div>
<p>Table – Summary of structural variables of forest sites (mean ± sd). Measures refer to trees and dead wood having, respectively, a DBH or mid-diameter &gt;10 cm. {#tbl:TableS2 tag=“S2”}
| Site | Aboveground Carbon (Mg C ha-1) | Growing Stock (m3 ha-1) | Basal Area (m2 ha-1) | CWD (m3 ha-1) | CWD ratio | DW density (ha-1) | Stump density (ha-1) | Tree Species Richness | | |
|—————————- |—————————————– |——————————- |——————————- |———————— |——————- |—————————- |—————————- |—————————– |— |— |
| Auberive | 71.27 ± 18.64 | 177.15 ± 41.95 | 18.17 ± 4.58 | 18.95 ± 36.97 | 0.09 ± 0.15 | 15.55 ± 21.19 | 5.06 ± 13.12 | 3.64 ± 1.53 | | |
| Ballons-Comtois | 167.83 ± 67.51 | 380.97 ± 130.56 | 32.6 ± 11.25 | 29.19 ± 25.42 | 0.07 ± 0.06 | 23.3 ± 40.75 | 24.37 ± 39.62 | 1.71 ± 0.83 | | |
| Bauges | 191.76 ± 57.79 | 669.3 ± 220.61 | 50.37 ± 15.56 | 25.14 ± 27.2 | 0.03 ± 0.03 | 77.3 ± 82.98 | 99.19 ± 99.43 | 4.36 ± 1.19 | | |
| Bois du Parc | 61.63 ± 15.48 | 152 ± 38.18 | 21.46 ± 5.92 | 1.44 ± 3.34 | 0.01 ± 0.02 | 17.68 ± 32.27 | 3.54 ± 10.61 | 2.78 ± 0.97 | | |
| Cajada | 169.41 ± 48.52 | 666.86 ± 196.8 | 49.3 ± 13.12 | 24.83 ± 8.66 | 0.04 ± 0.01 | 8.9 ± 10.35 | 436.8 ± 147.37 | 2.9 ± 0.32 | | |
| Chartreuse | 184.96 ± 42.78 | 620.35 ± 170.75 | 47.52 ± 12.72 | 23.33 ± 25.48 | 0.04 ± 0.04 | 47.49 ± 43.71 | 149.91 ± 101.66 | 4.19 ± 1.19 | | |
| Chizé | 68.72 ± 24.18 | 144.45 ± 50.83 | 17.47 ± 7.43 | 6.18 ± 7.75 | 0.04 ± 0.05 | 1.87 ± 7.72 | 60.85 ± 70.78 | 4.24 ± 1.39 | | |
| Cilento N | 154.05 ± 110.84 | 380.86 ± 278.7 | 34.98 ± 14.55 | 3.31 ± 6.45 | 0.01 ± 0.02 | 20.29 ± 43.66 | 29.1 ± 41.18 | 2.08 ± 1.5 | | |
| Cilento S | 149.41 ± 92.42 | 351.45 ± 220.9 | 34.6 ± 7.83 | 7.81 ± 12.74 | 0.03 ± 0.05 | 6.33 ± 9.1 | 64.41 ± 65.77 | 3.25 ± 2.05 | | |
| Citeaux | 153.3 ± 49.36 | 322.26 ± 103.77 | 34.91 ± 9.2 | 20.79 ± 17.34 | 0.06 ± 0.05 | 8.75 ± 12.69 | 25.46 ± 29.49 | 3.3 ± 0.67 | | |
| Combe Lavaux | 104.64 ± 67.85 | 241.94 ± 135.39 | 25.5 ± 11.13 | 3.44 ± 9.73 | 0.02 ± 0.05 | 25.86 ± 43.12 | 8.95 ± 16.71 | 3.5 ± 1.31 | | |
| Fontainebleau | 92.67 ± 27.23 | 215.81 ± 65.38 | 21.54 ± 5.35 | 64.4 ± 69.47 | 0.2 ± 0.18 | 8.91 ± 11.09 | 21.01 ± 35.8 | 1.92 ± 0.57 | | |
| Gran Sasso | 226.12 ± 53.74 | 590.38 ± 138.98 | 51.38 ± 8.3 | 2.64 ± 5.42 | 0 ± 0.01 | 30.73 ± 45.8 | 81.29 ± 77.16 | 1.68 ± 0.58 | | |
| Haut Tuileau | 101.69 ± 21.28 | 245.36 ± 51.39 | 25.3 ± 5.83 | 9.1 ± 12.62 | 0.04 ± 0.05 | 8.62 ± 19.63 | 112.07 ± 161.04 | 3.08 ± 0.79 | | |
| Haute-Chaine du Jura | 106.03 ± 48.75 | 261.52 ± 120.25 | 25.41 ± 7.98 | 15.65 ± 11.03 | 0.05 ± 0.04 | 41.12 ± 89.1 | 45.09 ± 45.76 | 3.33 ± 0.52 | | |
| Lure | 137.33 ± 25.02 | 331.06 ± 60.31 | 31.63 ± 6.45 | 14.31 ± 20.02 | 0.04 ± 0.05 | 28.42 ± 35.55 | 113.68 ± 88.82 | 2 ± 0.82 | | |
| Orseg | 150.72 ± 42.6 | 422.22 ± 109.29 | 33.62 ± 5.91 | 21.06 ± 18.84 | 0.05 ± 0.04 | 24.57 ± 26.07 | 180.71 ± 112.07 | 5.17 ± 1.6 | | |
| Rambouillet | 82.62 ± 28.19 | 199.19 ± 67.95 | 20.51 ± 7.6 | 5.41 ± 6.78 | 0.03 ± 0.04 | 5.47 ± 16.11 | 38.3 ± 68.96 | 2.25 ± 0.77 | | |
| Val Tovanella | 149.5 ± 38.05 | 566.28 ± 168.61 | 43.88 ± 8.85 | 38.59 ± 9.94 | 0.07 ± 0.02 | 116.2 ± 50.45 | 437.8 ± 47.04 | 4.1 ± 0.88 | | |
| Ventoux | 91.18 ± 41.16 | 314.24 ± 87.52 | 34.54 ± 9.44 | 17.52 ± 33.68 | 0.04 ± 0.06 | 84 ± 52.8 | 29.18 ± 41.16 | 1.44 ± 0.53 | | |
| Ventron | 151.95 ± 61.32 | 366.32 ± 147.83 | 30.05 ± 12.09 | 34.23 ± 18.6 | 0.08 ± 0.01 | 26.53 ± 20.03 | 34.48 ± 40.84 | 2 ± 0 | | |
| Vercors | 174.05 ± 63.75 | 556.76 ± 185.28 | 44.26 ± 15.44 | 19.2 ± 17.55 | 0.03 ± 0.02 | 55.26 ± 74.92 | 98.15 ± 76.86 | 3.61 ± 0.92 | | |
| Verrières | 86.64 ± 9.65 | 208.88 ± 23.27 | 24.33 ± 3.55 | 9.92 ± 13.27 | 0.04 ± 0.05 | 10.23 ± 12.76 | 135.28 ± 141.09 | 3 ± 1 | | |</p>
<p>Table S3 - Main characteristics of the sampling protocols across different datasets.</p>
<p>Additional references cited in Table S2:<br />
Blasi C, Marchetti M, Chiavetta U et al. (2010) Multi-taxon and forest structure sampling for identification of indicators and monitoring of old-growth forest. Plant Biosystems, 144, 160-170.
Bouvet A, Paillet Y, Archaux F, Tillon L, Denis P, Gilg O, Gosselin F (2016) Effects of forest structure, management and landscape on bird and bat communities. Environmental Conservation, 43, 148-160.
Brunialti G, Frati L, Aleffi M, Marignani M, Rosati L, Burrascano S, Ravera S (2010) Lichens and bryophytes as indicators of old-growth features in Mediterranean forests. Plant Biosystems, 144, 221-233.
Burrascano S, Sabatini FM, Blasi C (2011) Testing indicators of sustainable forest management on understorey composition and diversity in southern Italy through variation partitioning. Plant Ecology, 212, 829-841.<br />
Castellani C, Scrinzi G, Tabacchi G, Tosi V (1984) Inventario Forestale Nazionale Italiano (IFNI) Tavole di cubatura a doppia entrata. Istituto Sperimentale per l’Assestamento Forestale e per l’Alpicoltura, Trento.<br />
Janssen P, Bec S, Fuhr M, Taberlet P, Brun J J, Bouget C (2018). Present conditions may mediate the legacy effect of past land‐use changes on species richness and composition of above‐and below‐ground assemblages. Journal of Ecology 106, 306-318.
Janssen P, Cateau E, Fuhr M, Nusillard B, Brustel H, Bouget C (2016). Are biodiversity patterns of saproxylic beetles shaped by habitat limitation or dispersal limitation? A case study in unfragmented montane forests. Biodiversity and Conservation 25, 1167-1185.<br />
Kiraly I, Nascimbene J, Tinya F, Odor P (2013) Factors influencing epiphytic bryophyte and lichen species richness at different spatial scales in managed temperate forests. Biodiversity and Conservation, 22, 209-223.
Kutszegi G, Siller I, Dima B et al. (2015) Drivers of macrofungal species composition in temperate forests, West Hungary: functional groups compared. Fungal Ecology, 17, 69-83.<br />
Mag Z, Ódor P (2015) The effect of stand-level habitat characteristics on breeding bird assemblages in Hungarian temperate mixed forests. Community Ecology, 16, 156-166.
Márialigeti S, Németh B, Tinya F, Ódor P (2009) The effects of stand structure on ground-floor bryophyte assemblages in temperate mixed forests. Biodiversity and Conservation, 18, 2223.
Márialigeti S, Tinya F, Bidló A, Ódor P (2016) Environmental drivers of the composition and diversity of the herb layer in mixed temperate forests in Hungary. Plant Ecology, 217, 549-563.
Nascimbene J, Dainese M, Sitzia T (2013) Contrasting responses of epiphytic and dead wood-dwelling lichen diversity to forest management abandonment in silver fir mature woodlands. Forest Ecology and Management, 289, 325-332.<br />
Ódor P, Király I, Tinya F, Bortignon F, Nascimbene J (2013) Patterns and drivers of species composition of epiphytic bryophytes and lichens in managed temperate forests. Forest Ecology and Management, 306, 256-265.
Paillet Y, Pernot C, Boulanger V, Debaive N, Fuhr M, Gilg O, Gosselin F (2015) Quantifying the recovery of old-growth attributes in forest reserves: a first reference for France. Forest Ecology and Management, 346, 51-64.
Persiani AM, Audisio P, Lunghini D et al. (2010) Linking taxonomical and functional biodiversity of saproxylic fungi and beetles in broad-leaved forests in southern Italy with varying management histories. Plant Biosystems, 144, 250-261.<br />
Sabatini FM, Burrascano S, Azzella MM et al. (2016) One taxon does not fit all: Herb-layer diversity and stand structural complexity are weak predictors of biodiversity in Fagus sylvatica forests. Ecological Indicators, 69, 126-137.<br />
Sitzia T, Trentanovi G, Dainese M, Gobbo G, Lingua E, Sommacal M (2012) Stand structure and plant species diversity in managed and abandoned silver fir mature woodlands. Forest Ecology and Management, 270, 232-238.
Sitzia T, Campagnaro T, Dainese M et al. (2017) Contrasting multi-taxa diversity patterns between abandoned and non-intensively managed forests in the southern Dolomites. Iforest-Biogeosciences and Forestry, 10, 845.
Sitzia T, Campagnaro T, Gatti E, Sommacal M, Kotze D (2015) Wildlife conservation through forestry abandonment: responses of beetle communities to habitat change in the Eastern Alps. European Journal of Forest Research, 134, 511-524.
Sopp L, Kolozs L (2000) Fatömegszámítási táblázatok [Tables for calculating wood volume] Budapest, Állami Erdészeti Szolgálat.<br />
Tabacchi G, Di Cosmo L, Gasparini P, Morelli S (2011) Stima del volume e della fitomassa delle principali specie forestali italiane. Equazioni di previsione, tavole del volume e tavole della fitomassa arborea epigea. Consiglio per la Ricerca e la sperimentazione in Agricoltura, Unità di Ricerca per il Monitoraggio e la Pianificazione Forestale. Trento. 412 pp. Trento: Consiglio per la Ricerca e la sperimentazione in Agricoltura, Unita di Ricerca per il Monitoraggio e la Pianificazione Forestale (in Italian).</p>
<p>Nomenclatures and checklists<br />
Animals: 1) http://www.fauna-eu.org/ 2) http://www.gbif.org/ 3) http://www.organismnames.com/ 4) https://inpn.mnhn.fr/accueil/index
Bryophytes: Hodgetts N (2015) Checklist and Country Status of European Bryophytes: Towards a New Red List for Europe, National Parks and Wildlife Service.
Fungi: http://www.indexfungorum.org/names/names.asp<br />
Lichens: Nimis, P.L., Martellos, S., 2008. ITALIC – The Information System on Italian Lichens,Version 4.0. University of Trieste, Dept. of Biology, IN4.0/1(http://dbiodbs.univ.trieste.it/http://dbiodbs.univ.trieste.it/).<br />
Plants: The Plant List (2013). Version 1.1. Published on the Internet; http://www.theplantlist.org/ (accessed July 2016).</p>
<p>Table S4 – Correlation between principal components (PCs) and the 19 WorldClim bioclimatic variables. Bioclimatic variables were passively projected onto the PC space using the envfit function from the R package Vegan. To account for data nestedness (plots in sites), the permutation was constrained using forest sites as strata.</p>
<p>Table S5 – Sample Completeness for each taxonomic group in each site, as estimated using rarefaction curves (R package iNEXT).</p>
<p>Table S6 – Diagnostics of boosted regression tree models modelling multidiversity and the scaled richness of different taxonomic groups, when richness was scaled on the extrapolated size of the species pool.</p>
<p>Table S7 – Diagnostics of boosted regression tree models modelling multidiversity and the scaled richness of different taxonomic groups, when species richness was scaled on the observed number of the species of a given taxonomic group in a site.</p>
<p>Table S8 - Diagnostics of boosted regression tree models modelling multidiversity and the scaled richness of forest species (excluding beetles and fungi), when scaling richness on the extrapolated size of the species pool of a given taxonomic group in each site.</p>
<p>Table S9 – Diagnostics of boosted regression tree models modelling multidiversity and the scaled richness of non-forest species (excluding beetles and fungi), when scaling richness on the extrapolated size of the species pool of a given taxonomic group in each site.</p>
<p>Table S10 - Cross-match between the number of indicator species selected by TITAN as win-win vs. trade-off and expert-based classification into forest and non-forest species.</p>
<p>Figure S1 – Distribution of silvicultural systems across forests. The pie charts report the percentage of plots per site being managed with each system. Coppice w/st. - Coppice with standards.</p>
<p>Figure S2 – Interpolation and extrapolation curves for each taxonomic group in each site. Symbols represent observed species richness for the actual number of sampling units. Curves were built using the iNEXT package in R. Sample completeness is reported in Table S5. </p>
<p>Figure S3 – Scatterplot showing the relationship between scaled richness and aboveground carbon in individual forest sites. Dashed lines represent LOESS smoothers (span=1).</p>
<p>Figure S4 – Comparison of relative importance of the variables included in the Boosted Regression Tree modelling the relationship between above-ground live carbon and either multidiversity, or the scaled richness of different taxa, when scaled on the extrapolated size of the species pool.</p>
<p>Figure S5 – Partial dependency plots of the relationship between the scaled richness of beetles and the six top-performing explanatory variables as modelled through a Boosted Regression Tree. Scaled richness represents the fraction of species of the estimated species pool size observed in a given plot. Tick marks on the x-axis represent above-ground live carbon data distribution. For each variable, we report in parenthesis its relative importance.</p>
<p> </p>
<p>Figure S6 – Partial dependency plots of the relationship between the scaled richness of birds and the six top-performing explanatory variables as modelled through a Boosted Regression Tree. Scaled richness represents the fraction of species of the estimated species pool size observed in a given plot. Tick marks on the x-axis represent above-ground live carbon data distribution. For each variable, we report in parenthesis its relative importance.</p>
<p> </p>
<p>Figure S7 – Partial dependency plots of the relationship between the scaled richness of bryophytes and the six top-performing explanatory variables as modelled through a Boosted Regression Tree. Scaled richness represents the fraction of species of the estimated species pool size observed in a given plot. Tick marks on the x-axis represent above-ground live carbon data distribution. For each variable, we report in parenthesis its relative importance.</p>
<p> </p>
<p>Figure S8 - Partial dependency plots of the relationship between the scaled richness of fungi and the six top-performing explanatory variables as modelled through a Boosted Regression Tree. Scaled richness represents the fraction of species of the estimated species pool size observed in a given plot. Tick marks on the x-axis represent above-ground live carbon data distribution. For each variable, we report in parenthesis its relative importance.</p>
<p> </p>
<p>Figure S9 - Partial dependency plots of the relationship between the scaled richness of lichens and the six top-performing explanatory variables as modelled through a Boosted Regression Tree. Scaled richness represents the fraction of species of the estimated species pool size observed in a given plot. Tick marks on the x-axis represent above-ground live carbon data distribution. For each variable, we report in parenthesis its relative importance.</p>
<p> </p>
<p>Figure S10 - Partial dependency plots of the relationship between the scaled richness of plants and the six top-performing explanatory variables as modelled through a Boosted Regression Tree. Scaled richness represents the fraction of species of the estimated species pool size observed in a given plot. Tick marks on the x-axis represent above-ground live carbon data distribution. For each variable we report in parenthesis its relative importance.</p>
<p> </p>
<p>Figure S11 – Partial dependency plots of the relationship between the scaled richness of multidiversity and the six top-performing explanatory variables as modelled through a Boosted Regression Tree. Multidiversity represents the average of the scaled richness of different taxonomic groups, when this was scaled on the estimated species pool size observed in a given plot. Tick marks on the x-axis represent above-ground live carbon data distribution. For each variable we report in parenthesis its relative importance.</p>
<p> </p>
<p>Figure S12 – Comparison of relative importance of the variables included in the Boosted Regression Tree modelling the relationship between above-ground carbon and either multidiversity, or the scaled richness of different taxa, when scaled on the observed number of species for a given taxonomic group in a given site..
 </p>
<p>Figure S13 - Partial dependency plots of the relationship between scaled richness and above-ground live carbon, modelled using Boosted Regression Trees. Scaled richness represents the fraction of species of the observed number of species for a given taxonomic group in a given site. Ticks on the x-axis represent above-ground live carbon data distribution. For each taxonomic group, we report in parenthesis the relative importance of above-ground live carbon in the respective boosted regression tree model.
 </p>
<p>Figure S14 - Partial dependency plot of the relationship between multidiversity and above-ground live carbon using Boosted Regression Trees. Tick marks on the x-axis represent above-ground live carbon data distribution. Multidiversity represents the average of the scaled richness of different taxonomic groups, when this was scaled on the observed number of species in a given site. The relative importance of above-ground live carbon as an explanatory variable for multidiversity is 3.3%.</p>
<p>Figure S15 - Comparison of relative importance of the variables included in the Boosted Regression Trees modelling the relationship between above-ground live carbon and either multidiversity, or the scaled richness of different taxa (scaled on the observed number of species in a given site), when forest and non-forest species were considered separately.</p>
<p>Figure S16 - Partial dependency plots of the relationship between scaled richness of forest species and above-ground live carbon, modelled using Boosted Regression Trees. Scaled richness represents the fraction of species of the species pool size estimated for a given plot. Ticks on the x-axis represent aboveground live carbon data distribution. For each taxonomic group, we report in parenthesis the relative importance of above-ground live carbon in the respective boosted regression tree model.</p>
<p>Figure S17 – As Figure S17 but when considering non-forest species. </p>
<p>Figure S18 - Partial dependency plot of the relationship between multidiversity of forest species and above-ground live carbon using Boosted Regression Trees. Multidiversity represents the average of the scaled richness of different taxonomic groups, when this was scaled on the pool size of forest species estimated for the respective site. Tick marks on the x-axis represent above-ground live carbon data distribution.</p>
<p>Figure S19 – As Figure S19 for non-forest species</p>
<p>Figure S20 – Diving board plot of species-specific change-points for pure and reliable indicator species in oak-dominated forests. For win-win species, the horizontal lines extend from the highest observed above-ground live carbon value to the 5th percentile of the permuted distribution of change-points. For trade-off species the horizontal lines extend from the lowest observed above-ground live carbon value to the 95th percentile. The size of the symbols is proportional to species’ indicator value (z-scores). Only species having a level of purity and reliability higher than 0.95 were reported. We reported the limits of the confidence interval, as these conservatively indicate the point along the above-ground live carbon gradient above (below) which the trade-off (win-win) species potentially decline (increase).
 </p>
<p>Figure S21 – Diving board plot of species-specific change-points for pure and reliable indicator species in beech forests. Symbols as in Figure S20</p>
<!-- default theme -->

<style>
    /* import google fonts */
    @import url("https://fonts.googleapis.com/css?family=Open+Sans:400,600,700");
    @import url("https://fonts.googleapis.com/css?family=Source+Code+Pro");

    /* -------------------------------------------------- */
    /* global */
    /* -------------------------------------------------- */

    /* all elements */
    * {
        /* force sans-serif font unless specified otherwise */
        font-family: "Open Sans", "Helvetica", sans-serif;

        /* prevent text inflation on some mobile browsers */
        -webkit-text-size-adjust: none !important;
        -moz-text-size-adjust: none !important;
        -o-text-size-adjust: none !important;
        text-size-adjust: none !important;
    }

    @media only screen {
        /* "page" element */
        body {
            position: relative;
            box-sizing: border-box;
            font-size: 12pt;
            line-height: 1.5;
            max-width: 8.5in;
            margin: 20px auto;
            padding: 40px;
            border-radius: 5px;
            border: solid 1px #bdbdbd;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
            background: #ffffff;
        }
    }

    /* when on screen < 8.5in wide */
    @media only screen and (max-width: 8.5in) {
        /* "page" element */
        body {
            padding: 20px;
            margin: 0;
            border-radius: 0;
            border: none;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05) inset;
            background: none;
        }
    }

    /* -------------------------------------------------- */
    /* headings */
    /* -------------------------------------------------- */

    /* all headings */
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        margin: 20px 0;
        padding: 0;
        font-weight: bold;
    }

    /* biggest heading */
    h1 {
        margin: 40px 0;
        text-align: center;
    }

    /* second biggest heading */
    h2 {
        margin-top: 30px;
        padding-bottom: 5px;
        border-bottom: solid 1px #bdbdbd;
    }

    /* -------------------------------------------------- */
    /* manuscript header */
    /* -------------------------------------------------- */

    /* manuscript title */
    header > h1 {
        margin: 0;
    }

    /* manuscript title caption text (ie "automatically generated on") */
    header + p {
        text-align: center;
        margin-top: 10px;
    }

    /* -------------------------------------------------- */
    /* text elements */
    /* -------------------------------------------------- */

    /* links */
    a {
        color: #2196f3;
        overflow-wrap: break-word;
    }

    /* normal links (not empty, not button link, not syntax highlighting link) */
    a:not(:empty):not(.button):not(.sourceLine) {
        padding-left: 1px;
        padding-right: 1px;
    }

    /* superscripts and subscripts */
    sub,
    sup {
        /* prevent from affecting line height */
        line-height: 0;
    }

    /* unordered and ordered lists*/
    ul,
    ol {
        padding-left: 20px;
    }

    /* class for styling text semibold */
    .semibold {
        font-weight: 600;
    }

    /* class for styling elements horizontally left aligned */
    .left {
        display: block;
        text-align: left;
        margin-left: auto;
        margin-right: 0;
        justify-content: left;
    }

    /* class for styling elements horizontally centered */
    .center {
        display: block;
        text-align: center;
        margin-left: auto;
        margin-right: auto;
        justify-content: center;
    }

    /* class for styling elements horizontally right aligned */
    .right {
        display: block;
        text-align: right;
        margin-left: 0;
        margin-right: auto;
        justify-content: right;
    }

    /* -------------------------------------------------- */
    /* section elements */
    /* -------------------------------------------------- */

    /* horizontal divider line */
    hr {
        border: none;
        height: 1px;
        background: #bdbdbd;
    }

    /* paragraphs, horizontal dividers, figures, tables, code */
    p,
    hr,
    figure,
    table,
    pre {
        /* treat all as "paragraphs", with consistent vertical margins */
        margin-top: 20px;
        margin-bottom: 20px;
    }

    /* -------------------------------------------------- */
    /* figures */
    /* -------------------------------------------------- */

    /* figure */
    figure {
        max-width: 100%;
        margin-left: auto;
        margin-right: auto;
    }

    /* figure caption */
    figcaption {
        padding: 0;
        padding-top: 10px;
    }

    /* figure image element */
    figure img {
        max-width: 100%;
        display: block;
        margin-left: auto;
        margin-right: auto;
    }

    /* figure auto-number */
    img + figcaption > span:first-of-type {
        font-weight: bold;
        margin-right: 5px;
    }

    /* -------------------------------------------------- */
    /* tables */
    /* -------------------------------------------------- */

    /* table */
    table {
        border-collapse: collapse;
        border-spacing: 0;
        width: 100%;
        margin-left: auto;
        margin-right: auto;
    }

    /* table cells */
    th,
    td {
        border: solid 1px #bdbdbd;
        padding: 10px;
        /* squash table if too wide for page by forcing line breaks */
        overflow-wrap: break-word;
        word-break: break-word;
    }

    /* header row and even rows */
    th,
    tr:nth-child(2n) {
        background-color: #fafafa;
    }

    /* odd rows */
    tr:nth-child(2n + 1) {
        background-color: #ffffff;
    }

    /* table caption */
    caption {
        text-align: left;
        padding: 0;
        padding-bottom: 10px;
    }

    /* table auto-number */
    table > caption > span:first-of-type,
    div.table_wrapper > table > caption > span:first-of-type {
        font-weight: bold;
        margin-right: 5px;
    }

    /* -------------------------------------------------- */
    /* code */
    /* -------------------------------------------------- */

    /* multi-line code block */
    pre {
        padding: 10px;
        background-color: #eeeeee;
        color: #000000;
        border-radius: 5px;
        break-inside: avoid;
        text-align: left;
    }

    /* inline code, ie code within normal text */
    :not(pre) > code {
        padding: 0 4px;
        background-color: #eeeeee;
        color: #000000;
        border-radius: 5px;
    }

    /* code text */
    /* apply all children, to reach syntax highlighting sub-elements */
    code,
    code * {
        /* force monospace font */
        font-family: "Source Code Pro", "Courier New", monospace;
    }

    /* -------------------------------------------------- */
    /* quotes */
    /* -------------------------------------------------- */

    /* quoted text */
    blockquote {
        margin: 0;
        padding: 0;
        border-left: 4px solid #bdbdbd;
        padding-left: 16px;
        break-inside: avoid;
    }

    /* -------------------------------------------------- */
    /* banners */
    /* -------------------------------------------------- */

    /* info banners */
    .banner {
        box-sizing: border-box;
        display: block;
        position: relative;
        width: 100%;
        margin-top: 20px;
        margin-bottom: 20px;
        padding: 20px;
        text-align: center;
    }

    /* paragraph in banner */
    .banner > p {
        margin: 0;
    }

    /* -------------------------------------------------- */
    /* highlight colors */
    /* -------------------------------------------------- */

    .white {
        background: #ffffff;
    }
    .lightgrey {
        background: #eeeeee;
    }
    .grey {
        background: #757575;
    }
    .darkgrey {
        background: #424242;
    }
    .black {
        background: #000000;
    }
    .lightred {
        background: #ffcdd2;
    }
    .lightyellow {
        background: #ffecb3;
    }
    .lightgreen {
        background: #dcedc8;
    }
    .lightblue {
        background: #e3f2fd;
    }
    .lightpurple {
        background: #f3e5f5;
    }
    .red {
        background: #f44336;
    }
    .orange {
        background: #ff9800;
    }
    .yellow {
        background: #ffeb3b;
    }
    .green {
        background: #4caf50;
    }
    .blue {
        background: #2196f3;
    }
    .purple {
        background: #9c27b0;
    }
    .white,
    .lightgrey,
    .lightred,
    .lightyellow,
    .lightgreen,
    .lightblue,
    .lightpurple,
    .orange,
    .yellow,
    .white a,
    .lightgrey a,
    .lightred a,
    .lightyellow a,
    .lightgreen a,
    .lightblue a,
    .lightpurple a,
    .orange a,
    .yellow a {
        color: #000000;
    }
    .grey,
    .darkgrey,
    .black,
    .red,
    .green,
    .blue,
    .purple,
    .grey a,
    .darkgrey a,
    .black a,
    .red a,
    .green a,
    .blue a,
    .purple a {
        color: #ffffff;
    }

    /* -------------------------------------------------- */
    /* buttons */
    /* -------------------------------------------------- */

    /* class for styling links like buttons */
    .button {
        display: inline-flex;
        justify-content: center;
        align-items: center;
        margin: 5px;
        padding: 10px 20px;
        font-size: 0.75em;
        font-weight: 600;
        text-transform: uppercase;
        text-decoration: none;
        letter-spacing: 1px;
        background: none;
        color: #2196f3;
        border: solid 1px #bdbdbd;
        border-radius: 5px;
    }

    /* buttons when hovered */
    .button:hover:not([disabled]),
    .icon_button:hover:not([disabled]) {
        cursor: pointer;
        background: #f5f5f5;
    }

    /* buttons when disabled */
    .button[disabled],
    .icon_button[disabled] {
        opacity: 0.35;
        pointer-events: none;
    }

    /* class for styling buttons containg only single icon */
    .icon_button {
        display: inline-flex;
        justify-content: center;
        align-items: center;
        text-decoration: none;
        margin: 0;
        padding: 0;
        background: none;
        border-radius: 5px;
        border: none;
        width: 20px;
        height: 20px;
        min-width: 20px;
        min-height: 20px;
    }

    /* icon button inner svg image */
    .icon_button > svg {
        height: 16px;
    }

    /* -------------------------------------------------- */
    /* icons */
    /* -------------------------------------------------- */

    /* class for styling icons inline with text */
    .inline_icon {
        height: 1em;
        position: relative;
        top: 0.125em;
    }

    /* -------------------------------------------------- */
    /* print control */
    /* -------------------------------------------------- */

    @media print {
        @page {
            /* suggested printing margin */
            margin: 0.5in;
        }

        /* document and "page" elements */
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
        }

        /* "page" element */
        body {
            font-size: 11pt !important;
            line-height: 1.35;
        }

        /* all headings */
        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            margin: 15px 0;
        }

        /* heading 1 */
        h1 {
            font-size: 1.75em;
        }

        /* heading 2 */
        h2 {
            font-size: 1.25em;
            margin-top: 0;
        }

        /* heading 3 */
        h3 {
            font-size: 1.10em;
        }

        /* figures and tables */
        figure, table {
            font-size: 0.85em;
        }

        /* table cells */
        th,
        td {
            padding: 5px;
        }

        /* shrink font awesome icons */
        i.fas,
        i.fab,
        i.far,
        i.fal {
            transform: scale(0.85);
        }

        /* decrease banner margins */
        .banner {
            margin-top: 15px;
            margin-bottom: 15px;
            padding: 15px;
        }

        /* class for centering an element vertically on its own page */
        .page_center {
            margin: auto;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            vertical-align: middle;
            break-before: page;
            break-after: page;
        }

        /* always insert a page break before the element */
        .page_break_before {
            break-before: page;
        }

        /* always insert a page break after the element */
        .page_break_after {
            break-after: page;
        }

        /* avoid page break before the element */
        .page_break_before_avoid {
            break-before: avoid;
        }

        /* avoid page break after the element */
        .page_break_after_avoid {
            break-after: avoid;
        }

        /* avoid page break inside the element */
        .page_break_inside_avoid {
            break-inside: avoid;
        }
    }

    /* -------------------------------------------------- */
    /* override pandoc css quirks */
    /* -------------------------------------------------- */

    .sourceCode {
        /* prevent unsightly overflow in wide code blocks */
        overflow: auto !important;
    }

    div.sourceCode {
        /* prevent background fill on top-most code block  container */
        background: none !important;
    }

    .sourceCode * {
        /* force consistent line spacing */
        line-height: 1.5 !important;
    }

    div.sourceCode {
        /* style code block margins same as <pre> element */
        margin-top: 20px;
        margin-bottom: 20px;
    }

    /* -------------------------------------------------- */
    /* tablenos */
    /* -------------------------------------------------- */

    /* tablenos wrapper */
    .tablenos {
        /* show scrollbar on tables if necessary to prevent overflow */
        width: 100%;
        margin: 20px 0;
    }

    .tablenos > table {
        /* move margins from table to table_wrapper to allow margin collapsing */
        margin: 0;
    }

    @media only screen {
        /* tablenos wrapper */
        .tablenos {
            /* show scrollbar on tables if necessary to prevent overflow */
            overflow-x: auto !important;
        }

        .tablenos th,
        .tablenos td {
            overflow-wrap: unset !important;
            word-break: unset !important;
        }

        /* table in wrapper */
        .tablenos table,
        .tablenos table * {
            /* don't break table words */
            overflow-wrap: normal !important;
        }
    }

    /* -------------------------------------------------- */
    /* mathjax */
    /* -------------------------------------------------- */

    /* mathjax containers */
    .math.display > span:not(.MathJax_Preview) {
        /* turn inline element (no dimensions) into block (allows fixed width and thus scrolling) */
        display: flex !important;
        overflow-x: auto !important;
        overflow-y: hidden !important;
        justify-content: center;
        align-items: center;
        margin: 0 !important;
    }

    /* right click menu */
    .MathJax_Menu {
        border-radius: 5px !important;
        border: solid 1px #bdbdbd !important;
        box-shadow: none !important;
    }

    /* equation auto-number */
    span[id^="eq:"] > span.math.display + span {
        font-weight: 600;
    }

    /* equation */
    span[id^="eq:"] > span.math.display > span {
        /* nudge to make room for equation auto-number and anchor */
        margin-right: 60px !important;
    }

    /* -------------------------------------------------- */
    /* anchors plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* anchor button */
        .anchor {
            opacity: 0;
            margin-left: 5px;
        }

        /* anchor buttons within <h2>'s */
        h2 .anchor {
            margin-left: 10px;
        }

        /* anchor buttons when hovered/focused and anything containing an anchor button when hovered */
        *:hover > .anchor,
        .anchor:hover,
        .anchor:focus {
            opacity: 1;
        }

        /* anchor button when hovered */
        .anchor:hover {
            cursor: pointer;
        }
    }

    /* always show anchor button on devices with no mouse/hover ability */
    @media (hover: none) {
        .anchor {
            opacity: 1;
        }
    }

    /* always hide anchor button on print */
    @media only print {
        .anchor {
            display: none;
        }
    }

    /* -------------------------------------------------- */
    /* accordion plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* accordion arrow button */
        .accordion_arrow {
            margin-right: 10px;
        }

        /* arrow icon when <h2> data-collapsed attribute true */
        h2[data-collapsed="true"] > .accordion_arrow > svg {
            transform: rotate(-90deg);
        }

        /* all elements (except <h2>'s) when data-collapsed attribute true */
        *:not(h2)[data-collapsed="true"] {
            display: none;
        }

        /* accordion arrow button when hovered and <h2>'s when hovered */
        .accordion_arrow:hover,
        h2[data-collapsed="true"]:hover,
        h2[data-collapsed="false"]:hover {
            cursor: pointer;
        }
    }

    /* always hide accordion arrow button on print */
    @media only print {
        .accordion_arrow {
            display: none;
        }
    }

    /* -------------------------------------------------- */
    /* tooltips plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* tooltip container */
        #tooltip {
            position: absolute;
            width: 50%;
            min-width: 240px;
            max-width: 75%;
            z-index: 1;
        }

        /* tooltip content */
        #tooltip_content {
            margin-bottom: 5px;
            padding: 20px;
            border-radius: 5px;
            border: solid 1px #bdbdbd;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
            background: #ffffff;
            overflow-wrap: break-word;
        }

        /* tooltip copy of paragraphs and figures */
        #tooltip_content > p,
        #tooltip_content > figure {
            margin: 0;
            max-height: 320px;
            overflow-y: auto;
        }

        /* tooltip copy of <img> */
        #tooltip_content > figure > img {
            max-height: 260px;
        }

        /* navigation bar */
        #tooltip_nav_bar {
            margin-top: 10px;
            text-align: center;
        }

        /* navigation bar previous/next buton */
        #tooltip_nav_bar > .icon_button {
            position: relative;
            top: 3px;
        }

        /* navigation bar previous button */
        #tooltip_nav_bar > .icon_button:first-of-type {
            margin-right: 5px;
        }

        /* navigation bar next button */
        #tooltip_nav_bar > .icon_button:last-of-type {
            margin-left: 5px;
        }
    }

    /* always hide tooltip on print */
    @media only print {
        #tooltip {
            display: none;
        }
    }

    /* -------------------------------------------------- */
    /* jump to first plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* jump button */
        .jump_arrow {
            position: relative;
            top: 0.125em;
            margin-right: 5px;
        }
    }

    /* always hide jump button on print */
    @media only print {
        .jump_arrow {
            display: none;
        }
    }

    /* -------------------------------------------------- */
    /* link highlight plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* anything with data-highlighted attribute true */
        [data-highlighted="true"] {
            background: #ffeb3b;
        }

        /* anything with data-selected attribute true */
        [data-selected="true"] {
            background: #ff8a65 !important;
        }

        /* animation definition for glow */
        @keyframes highlight_glow {
            0% {
                background: none;
            }
            10% {
                background: #bbdefb;
            }
            100% {
                background: none;
            }
        }

        /* anything with data-glow attribute true */
        [data-glow="true"] {
            animation: highlight_glow 2s;
        }
    }

    /* -------------------------------------------------- */
    /* table of contents plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* toc panel */
        #toc_panel {
            box-sizing: border-box;
            position: fixed;
            top: 0;
            left: 0;
            background: #ffffff;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
            z-index: 2;
        }

        /* toc panel when closed */
        #toc_panel[data-open="false"] {
            min-width: 60px;
            width: 60px;
            height: 60px;
            border-right: solid 1px #bdbdbd;
            border-bottom: solid 1px #bdbdbd;
        }

        /* toc panel when open */
        #toc_panel[data-open="true"] {
            min-width: 260px;
            max-width: 480px;
            /* keep panel edge consistent distance away from "page" edge */
            width: calc(((100vw - 8.5in) / 2) - 30px - 40px);
            bottom: 0;
            border-right: solid 1px #bdbdbd;
        }

        /* toc panel header */
        #toc_header {
            box-sizing: border-box;
            display: flex;
            flex-direction: row;
            align-items: center;
            height: 60px;
            margin: 0;
            padding: 20px;
        }

        /* toc panel header when hovered */
        #toc_header:hover {
            cursor: pointer;
        }

        /* toc panel header when panel open */
        #toc_panel[data-open="true"] > #toc_header {
            border-bottom: solid 1px #bdbdbd;
        }

        /* toc open/close header button */
        #toc_button {
            margin-right: 20px;
        }

        /* hide toc list and header text when closed */
        #toc_panel[data-open="false"] > #toc_header > *:not(#toc_button),
        #toc_panel[data-open="false"] > #toc_list {
            display: none;
        }

        /* toc list of entries */
        #toc_list {
            box-sizing: border-box;
            width: 100%;
            padding: 20px;
            position: absolute;
            top: calc(60px + 1px);
            bottom: 0;
            overflow: auto;
        }

        /* toc entry, link to section in document */
        .toc_link {
            display: block;
            padding: 5px;
            position: relative;
            font-weight: 600;
            text-decoration: none;
        }

        /* toc entry when hovered or when "viewed" */
        .toc_link:hover,
        .toc_link[data-viewing="true"] {
            background: #f5f5f5;
        }

        /* toc entry, level 1 indentation */
        .toc_link[data-level="1"] {
            margin-left: 0;
        }

        /* toc entry, level 2 indentation */
        .toc_link[data-level="2"] {
            margin-left: 20px;
        }

        /* toc entry, level 3 indentation */
        .toc_link[data-level="3"] {
            margin-left: 40px;
        }

        /* toc entry, level 4 indentation */
        .toc_link[data-level="4"] {
            margin-left: 60px;
        }

        /* toc entry bullets */
        #toc_panel[data-bullets="true"] .toc_link[data-level]:before {
            position: absolute;
            left: -15px;
            top: -1px;
            font-size: 1.5em;
        }

        /* toc entry, level 2 bullet */
        #toc_panel[data-bullets="true"] .toc_link[data-level="2"]:before {
            content: "\2022";
        }

        /* toc entry, level 3 bullet */
        #toc_panel[data-bullets="true"] .toc_link[data-level="3"]:before {
            content: "\25AB";
        }

        /* toc entry, level 4 bullet */
        #toc_panel[data-bullets="true"] .toc_link[data-level="4"]:before {
            content: "-";
        }
    }

    /* when on screen < 8.5in wide */
    @media only screen and (max-width: 8.5in) {
        /* push <body> ("page") element down to make room for toc icon */
        .toc_body_nudge {
            padding-top: 60px;
        }

        /* toc icon when panel closed and not hovered */
        #toc_panel[data-open="false"]:not(:hover) {
            background: rgba(255, 255, 255, 0.75);
        }
    }

    /* always hide toc panel on print */
    @media only print {
        #toc_panel {
            display: none;
        }
    }

    /* -------------------------------------------------- */
    /* lightbox plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* regular <img> in document when hovered */
        .lightbox_document_img:hover {
            cursor: pointer;
        }

        .body_no_scroll {
            overflow: hidden !important;
        }

        /* screen overlay */
        #lightbox_overlay {
            display: flex;
            flex-direction: column;
            position: fixed;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.75);
            z-index: 3;
        }

        /* middle area containing lightbox image */
        #lightbox_image_container {
            flex-grow: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
            padding: 20px;
        }

        /* bottom area containing caption */
        #lightbox_bottom_container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100px;
            min-height: 100px;
            max-height: 100px;
            background: rgba(0, 0, 0, 0.5);
        }

        /* image number info text box */
        #lightbox_number_info {
            position: absolute;
            color: #ffffff;
            font-weight: 600;
            left: 2px;
            top: 0;
            z-index: 4;
        }

        /* zoom info text box */
        #lightbox_zoom_info {
            position: absolute;
            color: #ffffff;
            font-weight: 600;
            right: 2px;
            top: 0;
            z-index: 4;
        }

        /* copy of image caption */
        #lightbox_caption {
            box-sizing: border-box;
            display: inline-block;
            width: 100%;
            max-height: 100%;
            padding: 10px 0;
            text-align: center;
            overflow-y: auto;
            color: #ffffff;
        }

        /* navigation previous/next button */
        .lightbox_button {
            width: 100px;
            height: 100%;
            min-width: 100px;
            min-height: 100%;
            color: #ffffff;
        }

        /* navigation previous/next button when hovered */
        .lightbox_button:hover {
            background: none !important;
        }

        /* navigation button icon */
        .lightbox_button > svg {
            height: 25px;
        }

        /* figure auto-number */
        #lightbox_caption > span:first-of-type {
            font-weight: bold;
            margin-right: 5px;
        }

        /* lightbox image when hovered */
        #lightbox_img:hover {
            cursor: grab;
        }

        /* lightbox image when grabbed */
        #lightbox_img:active {
            cursor: grabbing;
        }
    }

    /* when on screen < 480px wide */
    @media only screen and (max-width: 480px) {
        /* make navigation buttons skinnier on small screens to make more room for caption text */
        .lightbox_button {
            width: 50px;
            min-width: 50px;
        }
    }

    /* always hide lightbox on print */
    @media only print {
        #lightbox_overlay {
            display: none;
        }
    }

    /* -------------------------------------------------- */
    /* hypothesis (annotations) plugin */
    /* -------------------------------------------------- */

    /* side panel */
    .annotator-frame {
        width: 280px !important;
        z-index: 0 !important;
    }

    /* match highlight color to rest of theme */
    .annotator-highlights-always-on .annotator-hl {
        background-color: #ffeb3b !important;
    }

    /* match focused color to rest of theme */
    .annotator-hl.annotator-hl-focused {
        background-color: #ff8a65 !important;
    }

    /* match bucket bar color to rest of theme */
    .annotator-bucket-bar {
        background: #f5f5f5 !important;
    }

    /* always hide toolbar and tooltip on print */
    @media only print {
        .annotator-frame {
            display: none !important;
        }

        hypothesis-adder {
            display: none !important;
        }
    }
</style>
<!-- anchors plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin adds an anchor next to each of a certain type
        // of element that provides a human-readable url to that specific
        // item/position in the document (eg "manuscript.html#abstract"). It
        // also makes it such that scrolling out of view of a target removes
        // its identifier from the url.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'anchors';

        // default plugin options
        const options = {
            // which types of elements to add anchors next to, in
            // "document.querySelector" format
            typesQuery: 'h1, h2, h3, [id^="fig:"], [id^="tbl:"], [id^="eq:"]',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            // add anchor to each element of specified types
            const elements = document.querySelectorAll(options.typesQuery);
            for (const element of elements)
                addAnchor(element);

            // attach scroll listener to window
            window.addEventListener('scroll', onScroll);
        }

        // when window is scrolled
        function onScroll() {
            // if url has hash and user has scrolled out of view of hash
            // target, remove hash from url
            const tolerance = 100;
            const target = getHashTarget();
            if (target) {
                if (
                    target.getBoundingClientRect().top >
                        window.innerHeight + tolerance ||
                    target.getBoundingClientRect().bottom < 0 - tolerance
                )
                    history.pushState(null, null, ' ');
            }
        }

        // add anchor to element
        function addAnchor(element) {
            let addTo; // element to add anchor button to

            // if figure or table, modify withId and addTo to get expected
            // elements
            if (element.id.indexOf('fig:') === 0) {
                addTo = element.querySelector('figcaption');
            } else if (element.id.indexOf('tbl:') === 0) {
                addTo = element.querySelector('caption');
            } else if (element.id.indexOf('eq:') === 0) {
                addTo = element.querySelector('.eqnos-number');
            }

            addTo = addTo || element;
            const id = element.id || null;

            // do not add anchor if element doesn't have assigned id.
            // id is generated by pandoc and is assumed to be unique and
            // human-readable
            if (!id)
                return;

            // create anchor button
            const anchor = document.createElement('a');
            anchor.innerHTML = document.querySelector('.icon_link').innerHTML;
            anchor.title = 'Link to this part of the document';
            anchor.classList.add('icon_button', 'anchor');
            anchor.dataset.ignore = 'true';
            anchor.href = '#' + id;
            addTo.appendChild(anchor);
        }

        // get element that is target of link or url hash
        function getHashTarget() {
            const hash = window.location.hash;
            const id = hash.slice(1);
            let target = document.querySelector('[id="' + id + '"]');
            if (!target)
                return;

            // if figure or table, modify target to get expected element
            if (id.indexOf('fig:') === 0)
                target = target.querySelector('figure');
            if (id.indexOf('tbl:') === 0)
                target = target.querySelector('table');

            return target;
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>

<!-- link icon -->

<template class="icon_link">
    <!-- modified from: https://fontawesome.com/icons/link -->
    <svg width="16" height="16" viewBox="0 0 512 512">
        <path
            fill="currentColor"
            d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"
        ></path>
    </svg>
</template>
<!-- accordion plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin allows sections of content under <h2> headings
        // to be collapsible.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'accordion';

        // default plugin options
        const options = {
            // whether to always start expanded ('false'), always start
            // collapsed ('true'), or start collapsed when screen small ('auto')
            startCollapsed: 'auto',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            // run through each <h2> heading
            const headings = document.querySelectorAll('h2');
            for (const heading of headings) {
                addArrow(heading);

                // start expanded/collapsed based on option
                if (
                    options.startCollapsed === 'true' ||
                    (options.startCollapsed === 'auto' && isSmallScreen())
                )
                    collapseHeading(heading);
                else
                    expandHeading(heading);
            }

            // attach hash change listener to window
            window.addEventListener('hashchange', onHashChange);
        }

        // when hash (eg manuscript.html#introduction) changes
        function onHashChange() {
            const target = getHashTarget();
            if (target)
                goToElement(target);
        }

        // add arrow to heading
        function addArrow(heading) {
            // add arrow button
            const arrow = document.createElement('button');
            arrow.innerHTML = document.querySelector(
                '.icon_angle_down'
            ).innerHTML;
            arrow.classList.add('icon_button', 'accordion_arrow');
            heading.insertBefore(arrow, heading.firstChild);

            // attach click listener to heading and button
            heading.addEventListener('click', onHeadingClick);
            arrow.addEventListener('click', onArrowClick);
        }

        // determine if on mobile-like device with small screen
        function isSmallScreen() {
            return Math.min(window.innerWidth, window.innerHeight) < 480;
        }

        // scroll to and focus element
        function goToElement(element, offset) {
            // expand accordion section if collapsed
            expandElement(element);
            const y =
                getRectInView(element).top -
                getRectInView(document.documentElement).top -
                (offset || 0);
            // trigger any function listening for "onscroll" event
            window.dispatchEvent(new Event('scroll'));
            window.scrollTo(0, y);
            document.activeElement.blur();
            element.focus();
        }

        // get element that is target of hash
        function getHashTarget(link) {
            const hash = link ? link.hash : window.location.hash;
            const id = hash.slice(1);
            let target = document.querySelector('[id="' + id + '"]');
            if (!target)
                return;

            // if figure or table, modify target to get expected element
            if (id.indexOf('fig:') === 0)
                target = target.querySelector('figure');
            if (id.indexOf('tbl:') === 0)
                target = target.querySelector('table');

            return target;
        }

        // when <h2> heading is clicked
        function onHeadingClick(event) {
            // only collapse if <h2> itself is target of click (eg, user did
            // not click on anchor within <h2>)
            if (event.target === this)
                toggleCollapse(this);
        }

        // when arrow button is clicked
        function onArrowClick() {
            toggleCollapse(this.parentNode);
        }

        // collapse section if expanded, expand if collapsed
        function toggleCollapse(heading) {
            if (heading.dataset.collapsed === 'false')
                collapseHeading(heading);
            else
                expandHeading(heading);
        }

        // elements to exclude from collapse, such as table of contents panel,
        // hypothesis panel, etc
        const exclude = '#toc_panel, div.annotator-frame, #lightbox_overlay';

        // collapse section
        function collapseHeading(heading) {
            heading.setAttribute('data-collapsed', 'true');
            const children = getChildren(heading);
            for (const child of children)
                child.setAttribute('data-collapsed', 'true');
        }

        // expand section
        function expandHeading(heading) {
            heading.setAttribute('data-collapsed', 'false');
            const children = getChildren(heading);
            for (const child of children)
                child.setAttribute('data-collapsed', 'false');
        }

        // get list of elements between this <h2> and next <h2> or <h1>
        // ("children" of the <h2> section)
        function getChildren(heading) {
            return nextUntil(heading, 'h2, h1', exclude);
        }

        // get position/dimensions of element or viewport
        function getRectInView(element) {
            let rect = {};
            rect.left = 0;
            rect.top = 0;
            rect.right = document.documentElement.clientWidth;
            rect.bottom = document.documentElement.clientHeight;
            let style = {};

            if (element instanceof HTMLElement) {
                rect = element.getBoundingClientRect();
                style = window.getComputedStyle(element);
            }

            const margin = {};
            margin.left = parseFloat(style.marginLeftWidth) || 0;
            margin.top = parseFloat(style.marginTopWidth) || 0;
            margin.right = parseFloat(style.marginRightWidth) || 0;
            margin.bottom = parseFloat(style.marginBottomWidth) || 0;

            const border = {};
            border.left = parseFloat(style.borderLeftWidth) || 0;
            border.top = parseFloat(style.borderTopWidth) || 0;
            border.right = parseFloat(style.borderRightWidth) || 0;
            border.bottom = parseFloat(style.borderBottomWidth) || 0;

            const newRect = {};
            newRect.left = rect.left + margin.left + border.left;
            newRect.top = rect.top + margin.top + border.top;
            newRect.right = rect.right + margin.right + border.right;
            newRect.bottom = rect.bottom + margin.bottom + border.bottom;
            newRect.width = newRect.right - newRect.left;
            newRect.height = newRect.bottom - newRect.top;

            return newRect;
        }

        // get list of elements after a start element up to element matching
        // query
        function nextUntil(element, query, exclude) {
            const elements = [];
            while (element = element.nextElementSibling, element) {
                if (element.matches(query))
                    break;
                if (!element.matches(exclude))
                    elements.push(element);
            }
            return elements;
        }

        // get closest element before specified element that matches query
        function firstBefore(element, query) {
            while (
                element &&
                element !== document.body &&
                !element.matches(query)
            )
                element = element.previousElementSibling || element.parentNode;

            return element;
        }

        // check if element is part of collapsed heading
        function isCollapsed(element) {
            while (element && element !== document.body) {
                if (element.dataset.collapsed === 'true')
                    return true;
                element = element.parentNode;
            }
            return false;
        }

        // expand heading containing element if necesary
        function expandElement(element) {
            if (isCollapsed(element)) {
                const heading = firstBefore(element, 'h2');
                if (heading)
                    heading.click();
            }
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>

<!-- angle down icon -->

<template class="icon_angle_down">
    <!-- modified from: https://fontawesome.com/icons/angle-down -->
    <svg width="16" height="16" viewBox="0 0 448 512">
        <path
            fill="currentColor"
            d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"
        ></path>
    </svg>
</template>
<!-- tooltips plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin makes it such that when the user hovers or
        // focuses a link to a citation or figure, a tooltip appears with a
        // preview of the reference content, along with arrows to navigate
        // between instances of the same reference in the document.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'tooltips';

        // default plugin options
        const options = {
            // whether user must click off to close tooltip instead of just
            // un-hovering
            clickClose: 'false',
            // delay (in ms) between opening and closing tooltip
            delay: '100',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            const links = getLinks();
            for (const link of links) {
                // attach hover and focus listeners to link
                link.addEventListener('mouseover', onLinkHover);
                link.addEventListener('mouseleave', onLinkUnhover);
                link.addEventListener('focus', onLinkFocus);
                link.addEventListener('touchend', onLinkTouch);
            }

            // attach mouse, key, and resize listeners to window
            window.addEventListener('mousedown', onClick);
            window.addEventListener('touchstart', onClick);
            window.addEventListener('keyup', onKeyUp);
            window.addEventListener('resize', onResize);
        }

        // when link is hovered
        function onLinkHover() {
            // function to open tooltip
            const delayOpenTooltip = function() {
                openTooltip(this);
            }.bind(this);

            // run open function after delay
            this.openTooltipTimer = window.setTimeout(
                delayOpenTooltip,
                options.delay
            );
        }

        // when mouse leaves link
        function onLinkUnhover() {
            // cancel opening tooltip
            window.clearTimeout(this.openTooltipTimer);

            // don't close on unhover if option specifies
            if (options.clickClose === 'true')
                return;

            // function to close tooltip
            const delayCloseTooltip = function() {
                // if tooltip open and if mouse isn't over tooltip, close
                const tooltip = document.getElementById('tooltip');
                if (tooltip && !tooltip.matches(':hover'))
                    closeTooltip();
            };

            // run close function after delay
            this.closeTooltipTimer = window.setTimeout(
                delayCloseTooltip,
                options.delay
            );
        }

        // when link is focused (tabbed to)
        function onLinkFocus(event) {
            openTooltip(this);
        }

        // when link is touched on touch screen
        function onLinkTouch(event) {
            // attempt to force hover state on first tap always, and trigger
            // regular link click (and navigation) on second tap
            if (event.target === document.activeElement)
                event.target.click();
            else {
                document.activeElement.blur();
                event.target.focus();
            }
            if (event.cancelable)
                event.preventDefault();
            event.stopPropagation();
            return false;
        }

        // when mouse is clicked anywhere in window
        function onClick(event) {
            closeTooltip();
        }

        // when key pressed
        function onKeyUp(event) {
            if (!event || !event.key)
                return;

            switch (event.key) {
                // trigger click of prev button
                case 'ArrowLeft':
                    const prevButton = document.getElementById(
                        'tooltip_prev_button'
                    );
                    if (prevButton)
                        prevButton.click();
                    break;
                // trigger click of next button
                case 'ArrowRight':
                    const nextButton = document.getElementById(
                        'tooltip_next_button'
                    );
                    if (nextButton)
                        nextButton.click();
                    break;
                // close on esc
                case 'Escape':
                    closeTooltip();
                    break;
            }
        }

        // when window is resized or zoomed
        function onResize() {
            closeTooltip();
        }

        // get all links of types we wish to handle
        function getLinks() {
            const queries = [];
            // exclude buttons, anchor links, toc links, etc
            const exclude =
                ':not(.button):not(.icon_button):not(.anchor):not(.toc_link)';
            queries.push('a[href^="#ref-"]' + exclude); // citation links
            queries.push('a[href^="#fig:"]' + exclude); // figure links
            const query = queries.join(', ');
            return document.querySelectorAll(query);
        }

        // get links with same target, get index of link in set, get total
        // same links
        function getSameLinks(link) {
            const sameLinks = [];
            const links = getLinks();
            for (const otherLink of links) {
                if (
                    otherLink.getAttribute('href') === link.getAttribute('href')
                )
                    sameLinks.push(otherLink);
            }

            return {
                elements: sameLinks,
                index: sameLinks.indexOf(link),
                total: sameLinks.length
            };
        }

        // open tooltip
        function openTooltip(link) {
            // delete tooltip if it exists, start fresh
            closeTooltip();

            // make tooltip element
            const tooltip = makeTooltip(link);

            // if source couldn't be found and tooltip not made, exit
            if (!tooltip)
                return;

            // make navbar elements
            const navBar = makeNavBar(link);
            if (navBar)
                tooltip.firstElementChild.appendChild(navBar);

            // attach tooltip to page
            document.body.appendChild(tooltip);

            // position tooltip
            const position = function() {
                positionTooltip(link);
            };
            position();

            // if tooltip contains images, position again after they've loaded
            const imgs = tooltip.querySelectorAll('img');
            for (const img of imgs)
                img.addEventListener('load', position);
        }

        // close (delete) tooltip
        function closeTooltip() {
            const tooltip = document.getElementById('tooltip');
            if (tooltip)
                tooltip.remove();
        }

        // make tooltip
        function makeTooltip(link) {
            // get target element that link points to
            const source = getSource(link);

            // if source can't be found, exit
            if (!source)
                return;

            // create new tooltip
            const tooltip = document.createElement('div');
            tooltip.id = 'tooltip';
            const tooltipContent = document.createElement('div');
            tooltipContent.id = 'tooltip_content';
            tooltip.appendChild(tooltipContent);

            // make copy of source node and put in tooltip
            const sourceCopy = makeCopy(source);
            tooltipContent.appendChild(sourceCopy);

            // attach mouse event listeners
            tooltip.addEventListener('click', onTooltipClick);
            tooltip.addEventListener('mousedown', onTooltipClick);
            tooltip.addEventListener('touchstart', onTooltipClick);
            tooltip.addEventListener('mouseleave', onTooltipUnhover);

            // (for interaction with lightbox plugin)
            // transfer click on tooltip copied img to original img
            const sourceImg = source.querySelector('img');
            const sourceCopyImg = sourceCopy.querySelector('img');
            if (sourceImg && sourceCopyImg) {
                const clickImg = function() {
                    sourceImg.click();
                    closeTooltip();
                };
                sourceCopyImg.addEventListener('click', clickImg);
            }

            return tooltip;
        }

        // make carbon copy of html dom element
        function makeCopy(source) {
            const sourceCopy = source.cloneNode(true);

            // delete elements marked with ignore (eg anchor and jump buttons)
            const deleteFromCopy = sourceCopy.querySelectorAll(
                '[data-ignore="true"]'
            );
            for (const element of deleteFromCopy)
                element.remove();

            // delete certain element attributes
            const attributes = [
                'id',
                'data-collapsed',
                'data-selected',
                'data-highlighted',
                'data-glow'
            ];
            for (const attribute of attributes) {
                sourceCopy.removeAttribute(attribute);
                const elements = sourceCopy.querySelectorAll(
                    '[' + attribute + ']'
                );
                for (const element of elements)
                    element.removeAttribute(attribute);
            }

            return sourceCopy;
        }

        // when tooltip is clicked
        function onTooltipClick(event) {
            // when user clicks on tooltip, stop click from transferring
            // outside of tooltip (eg, click off to close tooltip, or eg click
            // off to unhighlight same refs)
            event.stopPropagation();
        }

        // when tooltip is unhovered
        function onTooltipUnhover(event) {
            if (options.clickClose === 'true')
                return;

            // make sure new mouse/touch/focus no longer over tooltip or any
            // element within it
            const tooltip = document.getElementById('tooltip');
            if (!tooltip)
                return;
            if (this.contains(event.relatedTarget))
                return;

            closeTooltip();
        }

        // make nav bar to go betwen prev/next instances of same reference
        function makeNavBar(link) {
            // find other links to the same source
            const sameLinks = getSameLinks(link);

            // don't show nav bar when singular reference
            if (sameLinks.total <= 1)
                return;

            // find prev/next links with same target
            const prevLink = getPrevLink(link, sameLinks);
            const nextLink = getNextLink(link, sameLinks);

            // create nav bar
            const navBar = document.createElement('div');
            navBar.id = 'tooltip_nav_bar';
            const text = sameLinks.index + 1 + ' of ' + sameLinks.total;

            // create nav bar prev/next buttons
            const prevButton = document.createElement('button');
            const nextButton = document.createElement('button');
            prevButton.id = 'tooltip_prev_button';
            nextButton.id = 'tooltip_next_button';
            prevButton.title =
                'Jump to the previous occurence of this item in the document [←]';
            nextButton.title =
                'Jump to the next occurence of this item in the document [→]';
            prevButton.classList.add('icon_button');
            nextButton.classList.add('icon_button');
            prevButton.innerHTML = document.querySelector(
                '.icon_caret_left'
            ).innerHTML;
            nextButton.innerHTML = document.querySelector(
                '.icon_caret_right'
            ).innerHTML;
            navBar.appendChild(prevButton);
            navBar.appendChild(document.createTextNode(text));
            navBar.appendChild(nextButton);

            // attach click listeners to buttons
            prevButton.addEventListener('click', function() {
                onPrevNextClick(link, prevLink);
            });
            nextButton.addEventListener('click', function() {
                onPrevNextClick(link, nextLink);
            });

            return navBar;
        }

        // get previous link with same target
        function getPrevLink(link, sameLinks) {
            if (!sameLinks)
                sameLinks = getSameLinks(link);
            // wrap index to other side if < 1
            let index;
            if (sameLinks.index - 1 >= 0)
                index = sameLinks.index - 1;
            else
                index = sameLinks.total - 1;
            return sameLinks.elements[index];
        }

        // get next link with same target
        function getNextLink(link, sameLinks) {
            if (!sameLinks)
                sameLinks = getSameLinks(link);
            // wrap index to other side if > total
            let index;
            if (sameLinks.index + 1 <= sameLinks.total - 1)
                index = sameLinks.index + 1;
            else
                index = 0;
            return sameLinks.elements[index];
        }

        // get element that is target of link or url hash
        function getSource(link) {
            const hash = link ? link.hash : window.location.hash;
            const id = hash.slice(1);
            let target = document.querySelector('[id="' + id + '"]');
            if (!target)
                return;

            // if ref or figure, modify target to get expected element
            if (id.indexOf('ref-') === 0)
                target = target.querySelector('p');
            else if (id.indexOf('fig:') === 0)
                target = target.querySelector('figure');

            return target;
        }

        // when prev/next arrow button is clicked
        function onPrevNextClick(link, prevNextLink) {
            if (link && prevNextLink)
                goToElement(prevNextLink, window.innerHeight * 0.5);
        }

        // scroll to and focus element
        function goToElement(element, offset) {
            // expand accordion section if collapsed
            expandElement(element);
            const y =
                getRectInView(element).top -
                getRectInView(document.documentElement).top -
                (offset || 0);
            // trigger any function listening for "onscroll" event
            window.dispatchEvent(new Event('scroll'));
            window.scrollTo(0, y);
            document.activeElement.blur();
            element.focus();
        }

        // determine position to place tooltip based on link position in
        // viewport and tooltip size
        function positionTooltip(link, left, top) {
            const tooltipElement = document.getElementById('tooltip');
            if (!tooltipElement)
                return;

            // get convenient vars for position/dimensions of
            // link/tooltip/page/view
            link = getRectInPage(link);
            const tooltip = getRectInPage(tooltipElement);
            const view = getRectInPage();

            // horizontal positioning
            if (left)
                // use explicit value
                left = left;
            else if (link.left + tooltip.width < view.right)
                // fit tooltip to right of link
                left = link.left;
            else if (link.right - tooltip.width > view.left)
                // fit tooltip to left of link
                left = link.right - tooltip.width;
            // center tooltip in view
            else
                left = (view.right - view.left) / 2 - tooltip.width / 2;

            // vertical positioning
            if (top)
                // use explicit value
                top = top;
            else if (link.top - tooltip.height > view.top)
                // fit tooltip above link
                top = link.top - tooltip.height;
            else if (link.bottom + tooltip.height < view.bottom)
                // fit tooltip below link
                top = link.bottom;
            else {
                // center tooltip in view
                top = view.top + view.height / 2 - tooltip.height / 2;
                // nudge off of link to left/right if possible
                if (link.right + tooltip.width < view.right)
                    left = link.right;
                else if (link.left - tooltip.width > view.left)
                    left = link.left - tooltip.width;
            }

            tooltipElement.style.left = left + 'px';
            tooltipElement.style.top = top + 'px';
        }

        // get position/dimensions of element or viewport
        function getRectInView(element) {
            let rect = {};
            rect.left = 0;
            rect.top = 0;
            rect.right = document.documentElement.clientWidth;
            rect.bottom = document.documentElement.clientHeight;
            let style = {};

            if (element instanceof HTMLElement) {
                rect = element.getBoundingClientRect();
                style = window.getComputedStyle(element);
            }

            const margin = {};
            margin.left = parseFloat(style.marginLeftWidth) || 0;
            margin.top = parseFloat(style.marginTopWidth) || 0;
            margin.right = parseFloat(style.marginRightWidth) || 0;
            margin.bottom = parseFloat(style.marginBottomWidth) || 0;

            const border = {};
            border.left = parseFloat(style.borderLeftWidth) || 0;
            border.top = parseFloat(style.borderTopWidth) || 0;
            border.right = parseFloat(style.borderRightWidth) || 0;
            border.bottom = parseFloat(style.borderBottomWidth) || 0;

            const newRect = {};
            newRect.left = rect.left + margin.left + border.left;
            newRect.top = rect.top + margin.top + border.top;
            newRect.right = rect.right + margin.right + border.right;
            newRect.bottom = rect.bottom + margin.bottom + border.bottom;
            newRect.width = newRect.right - newRect.left;
            newRect.height = newRect.bottom - newRect.top;

            return newRect;
        }

        // get position of element relative to page
        function getRectInPage(element) {
            const rect = getRectInView(element);
            const body = getRectInView(document.body);

            const newRect = {};
            newRect.left = rect.left - body.left;
            newRect.top = rect.top - body.top;
            newRect.right = rect.right - body.left;
            newRect.bottom = rect.bottom - body.top;
            newRect.width = rect.width;
            newRect.height = rect.height;

            return newRect;
        }

        // (for interaction with accordion plugin)
        // get closest element before specified element that matches query
        function firstBefore(element, query) {
            while (
                element &&
                element !== document.body &&
                !element.matches(query)
            )
                element = element.previousElementSibling || element.parentNode;

            return element;
        }

        // (for interaction with accordion plugin)
        // check if element is part of collapsed heading
        function isCollapsed(element) {
            while (element && element !== document.body) {
                if (element.dataset.collapsed === 'true')
                    return true;
                element = element.parentNode;
            }
            return false;
        }

        // (for interaction with accordion plugin)
        // expand heading containing element if necesary
        function expandElement(element) {
            if (isCollapsed(element)) {
                const heading = firstBefore(element, 'h2');
                if (heading)
                    heading.click();
            }
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>

<!-- caret left icon -->

<template class="icon_caret_left">
    <!-- modified from: https://fontawesome.com/icons/caret-left -->
    <svg width="16" height="16" viewBox="0 0 192 512">
        <path
            fill="currentColor"
            d="M192 127.338v257.324c0 17.818-21.543 26.741-34.142 14.142L29.196 270.142c-7.81-7.81-7.81-20.474 0-28.284l128.662-128.662c12.599-12.6 34.142-3.676 34.142 14.142z"
        ></path>
    </svg>
</template>

<!-- caret right icon -->

<template class="icon_caret_right">
    <!-- modified from: https://fontawesome.com/icons/caret-right -->
    <svg width="16" height="16" viewBox="0 0 192 512">
        <path
            fill="currentColor"
            d="M0 384.662V127.338c0-17.818 21.543-26.741 34.142-14.142l128.662 128.662c7.81 7.81 7.81 20.474 0 28.284L34.142 398.804C21.543 411.404 0 402.48 0 384.662z"
        ></path>
    </svg>
</template>
<!-- jump to first plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin adds a button next to each reference entry,
        // figure, and table that jumps the page to the first occurrence of a
        // link to that item in the manuscript.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'jumpToFirst';

        // default plugin options
        const options = {
            // whether to add buttons next to reference entries
            references: 'true',
            // whether to add buttons next to figures
            figures: 'true',
            // whether to add buttons next to tables
            tables: 'true',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            if (options.references !== 'false')
                makeReferenceButtons();
            if (options.figures !== 'false')
                makeFigureButtons();
            if (options.tables !== 'false')
                makeTableButtons();
        }

        // when jump button clicked
        function onButtonClick() {
            const first = getFirstOccurrence(this.dataset.id);
            if (!first)
                return;

            // update url hash so navigating "back" in history will return
            // user to jump button
            window.location.hash = this.dataset.id;
            // scroll to link
            window.setTimeout(function() {
                goToElement(first, window.innerHeight * 0.5);
            }, 0);
        }

        // get first occurence of link to item in document
        function getFirstOccurrence(id) {
            let query = 'a';
            query += '[href="#' + id + '"]';
            // exclude buttons, anchor links, toc links, etc
            query +=
                ':not(.button):not(.icon_button):not(.anchor):not(.toc_link)';
            return document.querySelector(query);
        }

        // add button next to each reference entry
        function makeReferenceButtons() {
            const references = document.querySelectorAll('div[id^="ref-"]');
            for (const reference of references) {
                // get reference id and element to add button to
                const id = reference.id;
                const container = reference.firstElementChild;
                const first = getFirstOccurrence(id);

                // if can't find link to reference, ignore
                if (!first)
                    continue;

                // make jump button
                let button = document.createElement('button');
                button.classList.add('icon_button', 'jump_arrow');
                button.title =
                    'Jump to the first occurence of this reference in the document';
                button.innerHTML = document.querySelector(
                    '.icon_angle_double_up'
                ).innerHTML;
                button.dataset.id = id;
                button.dataset.ignore = 'true';
                container.innerHTML = button.outerHTML + container.innerHTML;
                button = container.firstElementChild;
                button.addEventListener('click', onButtonClick);
            }
        }

        // add button next to each figure
        function makeFigureButtons() {
            const figures = document.querySelectorAll('[id^="fig:"]');
            for (const figure of figures) {
                // get figure id and element to add button to
                const id = figure.id;
                const container = figure.querySelector('figcaption') || figure;
                const first = getFirstOccurrence(id);

                // if can't find link to figure, ignore
                if (!first)
                    continue;

                // make jump button
                const button = document.createElement('button');
                button.classList.add('icon_button', 'jump_arrow');
                button.title =
                    'Jump to the first occurence of this figure in the document';
                button.innerHTML = document.querySelector(
                    '.icon_angle_double_up'
                ).innerHTML;
                button.dataset.id = id;
                button.dataset.ignore = 'true';
                container.insertBefore(button, container.firstElementChild);
                button.addEventListener('click', onButtonClick);
            }
        }

        // add button next to each figure
        function makeTableButtons() {
            const tables = document.querySelectorAll('[id^="tbl:"]');
            for (const table of tables) {
                // get ref id and element to add button to
                const id = table.id;
                const container = table.querySelector('caption') || table;
                const first = getFirstOccurrence(id);

                // if can't find link to table, ignore
                if (!first)
                    continue;

                // make jump button
                const button = document.createElement('button');
                button.classList.add('icon_button', 'jump_arrow');
                button.title =
                    'Jump to the first occurence of this table in the document';
                button.innerHTML = document.querySelector(
                    '.icon_angle_double_up'
                ).innerHTML;
                button.dataset.id = id;
                button.dataset.ignore = 'true';
                container.insertBefore(button, container.firstElementChild);
                button.addEventListener('click', onButtonClick);
            }
        }

        // scroll to and focus element
        function goToElement(element, offset) {
            // expand accordion section if collapsed
            expandElement(element);
            const y =
                getRectInView(element).top -
                getRectInView(document.documentElement).top -
                (offset || 0);
            // trigger any function listening for "onscroll" event
            window.dispatchEvent(new Event('scroll'));
            window.scrollTo(0, y);
            document.activeElement.blur();
            element.focus();
        }

        // get position/dimensions of element or viewport
        function getRectInView(element) {
            let rect = {};
            rect.left = 0;
            rect.top = 0;
            rect.right = document.documentElement.clientWidth;
            rect.bottom = document.documentElement.clientHeight;
            let style = {};

            if (element instanceof HTMLElement) {
                rect = element.getBoundingClientRect();
                style = window.getComputedStyle(element);
            }

            const margin = {};
            margin.left = parseFloat(style.marginLeftWidth) || 0;
            margin.top = parseFloat(style.marginTopWidth) || 0;
            margin.right = parseFloat(style.marginRightWidth) || 0;
            margin.bottom = parseFloat(style.marginBottomWidth) || 0;

            const border = {};
            border.left = parseFloat(style.borderLeftWidth) || 0;
            border.top = parseFloat(style.borderTopWidth) || 0;
            border.right = parseFloat(style.borderRightWidth) || 0;
            border.bottom = parseFloat(style.borderBottomWidth) || 0;

            const newRect = {};
            newRect.left = rect.left + margin.left + border.left;
            newRect.top = rect.top + margin.top + border.top;
            newRect.right = rect.right + margin.right + border.right;
            newRect.bottom = rect.bottom + margin.bottom + border.bottom;
            newRect.width = newRect.right - newRect.left;
            newRect.height = newRect.bottom - newRect.top;

            return newRect;
        }

        // get closest element before specified element that matches query
        function firstBefore(element, query) {
            while (
                element &&
                element !== document.body &&
                !element.matches(query)
            )
                element = element.previousElementSibling || element.parentNode;

            return element;
        }

        // check if element is part of collapsed heading
        function isCollapsed(element) {
            while (element && element !== document.body) {
                if (element.dataset.collapsed === 'true')
                    return true;
                element = element.parentNode;
            }
            return false;
        }

        // (for interaction with accordion plugin)
        // expand heading containing element if necesary
        function expandElement(element) {
            if (isCollapsed(element)) {
                const heading = firstBefore(element, 'h2');
                if (heading)
                    heading.click();
            }
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>

<!-- angle double up icon -->

<template class="icon_angle_double_up">
    <!-- modified from: https://fontawesome.com/icons/angle-double-up -->
    <svg width="16" height="16" viewBox="0 0 320 512">
        <path
            fill="currentColor"
            d="M177 255.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 351.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 425.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1zm-34-192L7 199.7c-9.4 9.4-9.4 24.6 0 33.9l22.6 22.6c9.4 9.4 24.6 9.4 33.9 0l96.4-96.4 96.4 96.4c9.4 9.4 24.6 9.4 33.9 0l22.6-22.6c9.4-9.4 9.4-24.6 0-33.9l-136-136c-9.2-9.4-24.4-9.4-33.8 0z"
        ></path>
    </svg>
</template>
<!-- link highlight plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin makes it such that when a user hovers or
        // focuses a link, other links that have the same target will be
        // highlighted. It also makes it such that when clicking a link, the
        // target of the link (eg reference, figure, table) is briefly
        // highlighted.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'linkHighlight';

        // default plugin options
        const options = {
            // whether to also highlight links that go to external urls
            externalLinks: 'false',
            // whether user must click off to unhighlight instead of just
            // un-hovering
            clickUnhighlight: 'false',
            // whether to also highlight links that are unique
            highlightUnique: 'true',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            const links = getLinks();
            for (const link of links) {
                // attach mouse and focus listeners to link
                link.addEventListener('mouseenter', onLinkFocus);
                link.addEventListener('focus', onLinkFocus);
                link.addEventListener('mouseleave', onLinkUnhover);
            }

            // attach click and hash change listeners to window
            window.addEventListener('click', onClick);
            window.addEventListener('touchstart', onClick);
            window.addEventListener('hashchange', onHashChange);

            // run hash change on window load in case user has navigated
            // directly to hash
            onHashChange();
        }

        // when link is focused (tabbed to) or hovered
        function onLinkFocus() {
            highlight(this);
        }

        // when link is unhovered
        function onLinkUnhover() {
            if (options.clickUnhighlight !== 'true')
                unhighlightAll();
        }

        // when the mouse is clicked anywhere in window
        function onClick(event) {
            unhighlightAll();
        }

        // when hash (eg manuscript.html#introduction) changes
        function onHashChange() {
            const target = getHashTarget();
            if (target)
                glowElement(target);
        }

        // get element that is target of link or url hash
        function getHashTarget(link) {
            const hash = link ? link.hash : window.location.hash;
            const id = hash.slice(1);
            let target = document.querySelector('[id="' + id + '"]');
            if (!target)
                return;

            return target;
        }

        // start glow sequence on an element
        function glowElement(element) {
            const startGlow = function() {
                onGlowEnd();
                element.dataset.glow = 'true';
                element.addEventListener('animationend', onGlowEnd);
            };
            const onGlowEnd = function() {
                element.removeAttribute('data-glow');
                element.removeEventListener('animationend', onGlowEnd);
            };
            startGlow();
        }

        // highlight link and all others with same target
        function highlight(link) {
            // force unhighlight all to start fresh
            unhighlightAll();

            // get links with same target
            if (!link)
                return;
            const sameLinks = getSameLinks(link);

            // if link unique and option is off, exit and don't highlight
            if (sameLinks.length <= 1 && options.highlightUnique !== 'true')
                return;

            // highlight all same links, and "select" (special highlight) this
            // one
            for (const sameLink of sameLinks) {
                if (sameLink === link)
                    sameLink.setAttribute('data-selected', 'true');
                else
                    sameLink.setAttribute('data-highlighted', 'true');
            }
        }

        // unhighlight all links
        function unhighlightAll() {
            const links = getLinks();
            for (const link of links) {
                link.setAttribute('data-selected', 'false');
                link.setAttribute('data-highlighted', 'false');
            }
        }

        // get links with same target
        function getSameLinks(link) {
            const results = [];
            const links = getLinks();
            for (const otherLink of links) {
                if (
                    otherLink.getAttribute('href') === link.getAttribute('href')
                )
                    results.push(otherLink);
            }
            return results;
        }

        // get all links of types we wish to handle
        function getLinks() {
            let query = 'a';
            if (options.externalLinks !== 'true')
                query += '[href^="#"]';
            // exclude buttons, anchor links, toc links, etc
            query +=
                ':not(.button):not(.icon_button):not(.anchor):not(.toc_link)';
            return document.querySelectorAll(query);
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>
<!-- table of contents plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin provides a "table of contents" (toc) panel on
        // the side of the document that allows the user to conveniently
        // navigate between sections of the document.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'tableOfContents';

        // default plugin options
        const options = {
            // which types of elements to add links for, in
            // "document.querySelector" format
            typesQuery: 'h1, h2, h3',
            // whether default behavior is to be closed ('false'), open
            // ('true'), or only open when screen wide enough to fit panel
            // ('auto'). note: still always starts closed when page loads.
            open: 'auto',
            // if list item is more than this many characters, text will be
            // truncated
            charLimit: '50',
            // whether or not to show bullets next to each toc item
            bullets: 'false',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            // make toc panel and populate with entries (links to document
            // sections)
            const panel = makePanel();
            if (!panel)
                return;
            makeEntries(panel);
            document.body.insertBefore(panel, document.body.firstChild);

            closePanel();

            // attach click, scroll, and hash change listeners to window
            window.addEventListener('click', onClick);
            window.addEventListener('touchstart', onClick);
            window.addEventListener('scroll', onScroll);
            window.addEventListener('hashchange', onScroll);
            window.addEventListener('keyup', onKeyUp);
            onScroll();

            // add class to push document body down out of way of toc button
            document.body.classList.add('toc_body_nudge');
        }

        // determine if screen wide enough to fit toc panel
        function isSmallScreen() {
            // in default theme:
            // 816px = 8.5in = width of "page" (<body>) element
            // 260px = min width of toc panel (*2 for both sides of <body>)
            return window.innerWidth < 816 + 260 * 2;
        }

        // open/close panel based on option and screen size
        function openOrClosePanel() {
            if (
                options.open === 'true' ||
                (options.open === 'auto' && !isSmallScreen())
            )
                openPanel();
            else
                closePanel();
        }

        // when mouse is clicked anywhere in window
        function onClick() {
            const panel = document.getElementById('toc_panel');
            if (!panel)
                return;

            if (panel.dataset.open === 'true')
                openOrClosePanel();
        }

        // when window is scrolled or hash changed
        function onScroll() {
            highlightViewed();
        }

        // when key pressed
        function onKeyUp(event) {
            if (!event || !event.key)
                return;

            // close on esc
            if (event.key === 'Escape')
                closePanel();
        }

        // find entry of currently viewed document section in toc and highlight
        function highlightViewed() {
            const firstId = getFirstInView(options.typesQuery);

            // get toc entries (links), unhighlight all, then highlight viewed
            const list = document.getElementById('toc_list');
            if (!firstId || !list)
                return;
            const links = list.querySelectorAll('a');
            for (const link of links)
                link.dataset.viewing = 'false';
            const link = list.querySelector('a[href="#' + firstId + '"]');
            if (!link)
                return;
            link.dataset.viewing = 'true';
        }

        // get first or previous toc listed element in top half of view
        function getFirstInView(query) {
            // get all elements matching query and with id
            const elements = document.querySelectorAll(query);
            const elementsWithIds = [];
            for (const element of elements) {
                if (element.id)
                    elementsWithIds.push(element);
            }


            // get first or previous element in top half of view
            for (let i = 0; i < elementsWithIds.length; i++) {
                const element = elementsWithIds[i];
                const prevElement = elementsWithIds[Math.max(0, i - 1)];
                if (element.getBoundingClientRect().top >= 0) {
                    if (
                        element.getBoundingClientRect().top <
                        window.innerHeight / 2
                    )
                        return element.id;
                    else
                        return prevElement.id;
                }
            }
        }

        // make panel
        function makePanel() {
            // create panel
            const panel = document.createElement('div');
            panel.id = 'toc_panel';
            if (options.bullets === 'true')
                panel.dataset.bullets = 'true';

            // create header
            const header = document.createElement('div');
            header.id = 'toc_header';

            // create toc button
            const button = document.createElement('button');
            button.id = 'toc_button';
            button.innerHTML = document.querySelector(
                '.icon_th_list'
            ).innerHTML;
            button.classList.add('icon_button');

            // create header text
            const text = document.createElement('h3');
            text.innerHTML = 'Table of Contents';

            // create container for toc list
            const list = document.createElement('div');
            list.id = 'toc_list';

            // attach click listeners
            panel.addEventListener('click', onPanelClick);
            header.addEventListener('click', onHeaderClick);
            button.addEventListener('click', onButtonClick);

            // attach elements
            header.appendChild(button);
            header.appendChild(text);
            panel.appendChild(header);
            panel.appendChild(list);

            return panel;
        }

        // create toc entries (links) to each element of the specified types
        function makeEntries(panel) {
            const elements = document.querySelectorAll(options.typesQuery);
            for (const element of elements) {
                // do not add link if element doesn't have assigned id
                if (!element.id)
                    continue;

                // create link/list item
                const link = document.createElement('a');
                link.classList.add('toc_link');
                switch (element.tagName.toLowerCase()) {
                    case 'h1':
                        link.dataset.level = '1';
                        break;
                    case 'h2':
                        link.dataset.level = '2';
                        break;
                    case 'h3':
                        link.dataset.level = '3';
                        break;
                    case 'h4':
                        link.dataset.level = '4';
                        break;
                }
                link.title = element.innerText;
                let text = element.innerText;
                if (text.length > options.charLimit)
                    text = text.slice(0, options.charLimit) + '...';
                link.innerHTML = text;
                link.href = '#' + element.id;
                link.addEventListener('click', onLinkClick);

                // attach link
                panel.querySelector('#toc_list').appendChild(link);
            }
        }

        // when panel is clicked
        function onPanelClick(event) {
            // stop click from propagating to window/document and closing panel
            event.stopPropagation();
        }

        // when header itself is clicked
        function onHeaderClick(event) {
            togglePanel();
        }

        // when button is clicked
        function onButtonClick(event) {
            togglePanel();
            // stop header underneath button from also being clicked
            event.stopPropagation();
        }

        // when link is clicked
        function onLinkClick() {
            openOrClosePanel();
        }

        // open panel if closed, close if opened
        function togglePanel() {
            const panel = document.getElementById('toc_panel');
            if (!panel)
                return;

            if (panel.dataset.open === 'true')
                closePanel();
            else
                openPanel();
        }

        // open panel
        function openPanel() {
            const panel = document.getElementById('toc_panel');
            if (panel)
                panel.dataset.open = 'true';
        }

        // close panel
        function closePanel() {
            const panel = document.getElementById('toc_panel');
            if (panel)
                panel.dataset.open = 'false';
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>

<!-- th list icon -->

<template class="icon_th_list">
    <!-- modified from: https://fontawesome.com/icons/th-list -->
    <svg width="16" height="16" viewBox="0 0 512 512" tabindex="-1">
        <path
            fill="currentColor"
            d="M96 96c0 26.51-21.49 48-48 48S0 122.51 0 96s21.49-48 48-48 48 21.49 48 48zM48 208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm0 160c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm96-236h352c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"
            tabindex="-1"
        ></path>
    </svg>
</template>
<!-- lightbox plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin makes it such that when a user clicks on an
        // image, the image fills the screen and the user can pan/drag/zoom
        // the image and navigate between other images in the document.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'lightbox';

        // default plugin options
        const options = {
            // list of possible zoom/scale factors
            zoomSteps:
                '0.1, 0.25, 0.333333, 0.5, 0.666666, 0.75, 1,' +
                '1.25, 1.5, 1.75, 2, 2.5, 3, 3.5, 4, 5, 6, 7, 8',
            // whether to fit image to view ('fit'), display at 100% and shrink
            // if necessary ('shrink'), or always display at 100% ('100')
            defaultZoom: 'fit',
            // whether to zoom in/out toward center of view ('true') or mouse
            // ('false')
            centerZoom: 'false',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            // run through each <img> element
            const imgs = document.querySelectorAll('figure > img');
            let count = 1;
            for (const img of imgs) {
                img.classList.add('lightbox_document_img');
                img.dataset.number = count;
                img.dataset.total = imgs.length;
                img.addEventListener('click', openLightbox);
                count++;
            }

            // attach mouse and key listeners to window
            window.addEventListener('mousemove', onWindowMouseMove);
            window.addEventListener('keyup', onKeyUp);
        }

        // when mouse is moved anywhere in window
        function onWindowMouseMove(event) {
            window.mouseX = event.clientX;
            window.mouseY = event.clientY;
        }

        // when key pressed
        function onKeyUp(event) {
            if (!event || !event.key)
                return;

            switch (event.key) {
                // trigger click of prev button
                case 'ArrowLeft':
                    const prevButton = document.getElementById(
                        'lightbox_prev_button'
                    );
                    if (prevButton)
                        prevButton.click();
                    break;
                // trigger click of next button
                case 'ArrowRight':
                    const nextButton = document.getElementById(
                        'lightbox_next_button'
                    );
                    if (nextButton)
                        nextButton.click();
                    break;
                // close on esc
                case 'Escape':
                    closeLightbox();
                    break;
            }
        }

        // open lightbox
        function openLightbox() {
            const lightbox = makeLightbox(this);
            if (!lightbox)
                return;

            blurBody(lightbox);
            document.body.appendChild(lightbox);
        }

        // make lightbox
        function makeLightbox(img) {
            // delete lightbox if it exists, start fresh
            closeLightbox();

            // create screen overlay containing lightbox
            const overlay = document.createElement('div');
            overlay.id = 'lightbox_overlay';

            // create image info boxes
            const numberInfo = document.createElement('div');
            const zoomInfo = document.createElement('div');
            numberInfo.id = 'lightbox_number_info';
            zoomInfo.id = 'lightbox_zoom_info';

            // create container for image
            const imageContainer = document.createElement('div');
            imageContainer.id = 'lightbox_image_container';
            const lightboxImg = makeLightboxImg(
                img,
                imageContainer,
                numberInfo,
                zoomInfo
            );
            imageContainer.appendChild(lightboxImg);

            // create bottom container for caption and navigation buttons
            const bottomContainer = document.createElement('div');
            bottomContainer.id = 'lightbox_bottom_container';
            const caption = makeCaption(img);
            const prevButton = makePrevButton(img);
            const nextButton = makeNextButton(img);
            bottomContainer.appendChild(prevButton);
            bottomContainer.appendChild(caption);
            bottomContainer.appendChild(nextButton);

            // attach top middle and bottom to overlay
            overlay.appendChild(numberInfo);
            overlay.appendChild(zoomInfo);
            overlay.appendChild(imageContainer);
            overlay.appendChild(bottomContainer);

            return overlay;
        }

        // make <img> object that is intuitively draggable and zoomable
        function makeLightboxImg(
            sourceImg,
            container,
            numberInfoBox,
            zoomInfoBox
        ) {
            // create copy of source <img>
            const img = sourceImg.cloneNode(true);
            img.classList.remove('lightbox_document_img');
            img.removeAttribute('id');
            img.removeAttribute('width');
            img.removeAttribute('height');
            img.style.position = 'unset';
            img.style.margin = '0';
            img.style.padding = '0';
            img.style.width = '';
            img.style.height = '';
            img.style.minWidth = '';
            img.style.minHeight = '';
            img.style.maxWidth = '';
            img.style.maxHeight = '';
            img.id = 'lightbox_img';

            // build sorted list of unique zoomSteps, always including a 100%
            let zoomSteps = [];
            const optionsZooms = options.zoomSteps.split(/[^0-9.]/);
            for (const optionZoom of optionsZooms) {
                const newZoom = parseFloat(optionZoom);
                if (newZoom && !zoomSteps.includes(newZoom))
                    zoomSteps.push(newZoom);
            }
            if (!zoomSteps.includes(1))
                zoomSteps.push(1);
            zoomSteps = zoomSteps.sort(function sortNumber(a, b) {
                return a - b;
            });

            // <img> object property variables
            let zoom = 1;
            let translateX = 0;
            let translateY = 0;
            let clickMouseX = undefined;
            let clickMouseY = undefined;
            let clickTranslateX = undefined;
            let clickTranslateY = undefined;

            updateNumberInfo();

            // update image numbers displayed in info box
            function updateNumberInfo() {
                numberInfoBox.innerHTML =
                    sourceImg.dataset.number + ' of ' + sourceImg.dataset.total;
            }

            // update zoom displayed in info box
            function updateZoomInfo() {
                let zoomInfo = zoom * 100;
                if (!Number.isInteger(zoomInfo))
                    zoomInfo = zoomInfo.toFixed(2);
                zoomInfoBox.innerHTML = zoomInfo + '%';
            }

            // move to closest zoom step above current zoom
            const zoomIn = function() {
                for (const zoomStep of zoomSteps) {
                    if (zoomStep > zoom) {
                        zoom = zoomStep;
                        break;
                    }
                }
                updateTransform();
            };

            // move to closest zoom step above current zoom
            const zoomOut = function() {
                zoomSteps.reverse();
                for (const zoomStep of zoomSteps) {
                    if (zoomStep < zoom) {
                        zoom = zoomStep;
                        break;
                    }
                }
                zoomSteps.reverse();

                updateTransform();
            };

            // update display of <img> based on scale/translate properties
            const updateTransform = function() {
                // set transform
                img.style.transform =
                    'translate(' +
                    (translateX || 0) +
                    'px,' +
                    (translateY || 0) +
                    'px) scale(' +
                    (zoom || 1) +
                    ')';

                // get new width/height after scale
                const rect = img.getBoundingClientRect();
                // limit translate
                translateX = Math.max(translateX, -rect.width / 2);
                translateX = Math.min(translateX, rect.width / 2);
                translateY = Math.max(translateY, -rect.height / 2);
                translateY = Math.min(translateY, rect.height / 2);

                // set transform
                img.style.transform =
                    'translate(' +
                    (translateX || 0) +
                    'px,' +
                    (translateY || 0) +
                    'px) scale(' +
                    (zoom || 1) +
                    ')';

                updateZoomInfo();
            };

            // fit <img> to container
            const fit = function() {
                // no x/y offset, 100% zoom by default
                translateX = 0;
                translateY = 0;
                zoom = 1;

                // widths of <img> and container
                const imgWidth = img.naturalWidth;
                const imgHeight = img.naturalHeight;
                const containerWidth = parseFloat(
                    window.getComputedStyle(container).width
                );
                const containerHeight = parseFloat(
                    window.getComputedStyle(container).height
                );

                // how much zooming is needed to fit <img> to container
                const xRatio = imgWidth / containerWidth;
                const yRatio = imgHeight / containerHeight;
                const maxRatio = Math.max(xRatio, yRatio);
                const newZoom = 1 / maxRatio;

                // fit <img> to container according to option
                if (options.defaultZoom === 'shrink') {
                    if (maxRatio > 1)
                        zoom = newZoom;
                } else if (options.defaultZoom === 'fit')
                    zoom = newZoom;

                updateTransform();
            };

            // when mouse wheel is rolled anywhere in container
            const onContainerWheel = function(event) {
                if (!event)
                    return;

                // let ctrl + mouse wheel to zoom behave as normal
                if (event.ctrlKey)
                    return;

                // prevent normal scroll behavior
                event.preventDefault();
                event.stopPropagation();

                // point around which to scale img
                const viewRect = container.getBoundingClientRect();
                const viewX = (viewRect.left + viewRect.right) / 2;
                const viewY = (viewRect.top + viewRect.bottom) / 2;
                const originX = options.centerZoom === 'true' ? viewX : mouseX;
                const originY = options.centerZoom === 'true' ? viewY : mouseY;

                // get point on image under origin
                const oldRect = img.getBoundingClientRect();
                const oldPercentX = (originX - oldRect.left) / oldRect.width;
                const oldPercentY = (originY - oldRect.top) / oldRect.height;

                // increment/decrement zoom
                if (event.deltaY < 0)
                    zoomIn();
                if (event.deltaY > 0)
                    zoomOut();

                // get offset between previous image point and origin
                const newRect = img.getBoundingClientRect();
                const offsetX =
                    originX - (newRect.left + newRect.width * oldPercentX);
                const offsetY =
                    originY - (newRect.top + newRect.height * oldPercentY);

                // translate image to keep image point under origin
                translateX += offsetX;
                translateY += offsetY;

                // perform translate
                updateTransform();
            };

            // when container is clicked
            function onContainerClick(event) {
                // if container itself is target of click, and not other
                // element above it
                if (event.target === this)
                    closeLightbox();
            }

            // when mouse button is pressed on image
            const onImageMouseDown = function(event) {
                // store original mouse position relative to image
                clickMouseX = window.mouseX;
                clickMouseY = window.mouseY;
                clickTranslateX = translateX;
                clickTranslateY = translateY;
                event.stopPropagation();
                event.preventDefault();
            };

            // when mouse button is released anywhere in window
            const onWindowMouseUp = function(event) {
                // reset original mouse position
                clickMouseX = undefined;
                clickMouseY = undefined;
                clickTranslateX = undefined;
                clickTranslateY = undefined;

                // remove global listener if lightbox removed from document
                if (!document.body.contains(container))
                    window.removeEventListener('mouseup', onWindowMouseUp);
            };

            // when mouse is moved anywhere in window
            const onWindowMouseMove = function(event) {
                if (
                    clickMouseX === undefined ||
                    clickMouseY === undefined ||
                    clickTranslateX === undefined ||
                    clickTranslateY === undefined
                )
                    return;

                // offset image based on original and current mouse position
                translateX = clickTranslateX + window.mouseX - clickMouseX;
                translateY = clickTranslateY + window.mouseY - clickMouseY;
                updateTransform();
                event.preventDefault();

                // remove global listener if lightbox removed from document
                if (!document.body.contains(container))
                    window.removeEventListener('mousemove', onWindowMouseMove);
            };

            // when window is resized
            const onWindowResize = function(event) {
                fit();

                // remove global listener if lightbox removed from document
                if (!document.body.contains(container))
                    window.removeEventListener('resize', onWindowResize);
            };

            // attach the necessary event listeners
            img.addEventListener('dblclick', fit);
            img.addEventListener('mousedown', onImageMouseDown);
            container.addEventListener('wheel', onContainerWheel);
            container.addEventListener('mousedown', onContainerClick);
            container.addEventListener('touchstart', onContainerClick);
            window.addEventListener('mouseup', onWindowMouseUp);
            window.addEventListener('mousemove', onWindowMouseMove);
            window.addEventListener('resize', onWindowResize);

            // run fit() after lightbox atttached to document and <img> Loaded
            // so needed container and img dimensions available
            img.addEventListener('load', fit);

            return img;
        }

        // make caption
        function makeCaption(img) {
            const caption = document.createElement('div');
            caption.id = 'lightbox_caption';
            const captionSource = img.nextElementSibling;
            if (captionSource.tagName.toLowerCase() === 'figcaption') {
                const captionCopy = makeCopy(captionSource);
                caption.innerHTML = captionCopy.innerHTML;
            }

            caption.addEventListener('touchstart', function(event) {
                event.stopPropagation();
            });

            return caption;
        }

        // make carbon copy of html dom element
        function makeCopy(source) {
            const sourceCopy = source.cloneNode(true);

            // delete elements marked with ignore (eg anchor and jump buttons)
            const deleteFromCopy = sourceCopy.querySelectorAll(
                '[data-ignore="true"]'
            );
            for (const element of deleteFromCopy)
                element.remove();

            // delete certain element attributes
            const attributes = [
                'id',
                'data-collapsed',
                'data-selected',
                'data-highlighted',
                'data-glow'
            ];
            for (const attribute of attributes) {
                sourceCopy.removeAttribute(attribute);
                const elements = sourceCopy.querySelectorAll(
                    '[' + attribute + ']'
                );
                for (const element of elements)
                    element.removeAttribute(attribute);
            }

            return sourceCopy;
        }

        // make button to jump to previous image in document
        function makePrevButton(img) {
            const prevButton = document.createElement('button');
            prevButton.id = 'lightbox_prev_button';
            prevButton.title = 'Jump to the previous image in the document [←]';
            prevButton.classList.add('icon_button', 'lightbox_button');
            prevButton.innerHTML = document.querySelector(
                '.icon_caret_left'
            ).innerHTML;

            // attach click listeners to button
            prevButton.addEventListener('click', function() {
                getPrevImg(img).click();
            });

            return prevButton;
        }

        // make button to jump to next image in document
        function makeNextButton(img) {
            const nextButton = document.createElement('button');
            nextButton.id = 'lightbox_next_button';
            nextButton.title = 'Jump to the next image in the document [→]';
            nextButton.classList.add('icon_button', 'lightbox_button');
            nextButton.innerHTML = document.querySelector(
                '.icon_caret_right'
            ).innerHTML;

            // attach click listeners to button
            nextButton.addEventListener('click', function() {
                getNextImg(img).click();
            });

            return nextButton;
        }

        // get previous image in document
        function getPrevImg(img) {
            const imgs = document.querySelectorAll('.lightbox_document_img');

            // find index of provided img
            let index;
            for (index = 0; index < imgs.length; index++) {
                if (imgs[index] === img)
                    break;
            }


            // wrap index to other side if < 1
            if (index - 1 >= 0)
                index--;
            else
                index = imgs.length - 1;
            return imgs[index];
        }

        // get next image in document
        function getNextImg(img) {
            const imgs = document.querySelectorAll('.lightbox_document_img');

            // find index of provided img
            let index;
            for (index = 0; index < imgs.length; index++) {
                if (imgs[index] === img)
                    break;
            }


            // wrap index to other side if > total
            if (index + 1 <= imgs.length - 1)
                index++;
            else
                index = 0;
            return imgs[index];
        }

        // close lightbox
        function closeLightbox() {
            focusBody();

            const lightbox = document.getElementById('lightbox_overlay');
            if (lightbox)
                lightbox.remove();
        }

        // make all elements behind lightbox non-focusable
        function blurBody(overlay) {
            const all = document.querySelectorAll('*');
            for (const element of all)
                element.tabIndex = -1;
            document.body.classList.add('body_no_scroll');
        }

        // make all elements focusable again
        function focusBody() {
            const all = document.querySelectorAll('*');
            for (const element of all)
                element.removeAttribute('tabIndex');
            document.body.classList.remove('body_no_scroll');
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>

<!-- caret left icon -->

<template class="icon_caret_left">
    <!-- modified from: https://fontawesome.com/icons/caret-left -->
    <svg width="16" height="16" viewBox="0 0 192 512">
        <path
            fill="currentColor"
            d="M192 127.338v257.324c0 17.818-21.543 26.741-34.142 14.142L29.196 270.142c-7.81-7.81-7.81-20.474 0-28.284l128.662-128.662c12.599-12.6 34.142-3.676 34.142 14.142z"
        ></path>
    </svg>
</template>

<!-- caret right icon -->

<template class="icon_caret_right">
    <!-- modified from: https://fontawesome.com/icons/caret-right -->
    <svg width="16" height="16" viewBox="0 0 192 512">
        <path
            fill="currentColor"
            d="M0 384.662V127.338c0-17.818 21.543-26.741 34.142-14.142l128.662 128.662c7.81 7.81 7.81 20.474 0 28.284L34.142 398.804C21.543 411.404 0 402.48 0 384.662z"
        ></path>
    </svg>
</template>
<!-- attributes plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin allows arbitrary HTML attributes to be attached
        // to (almost) any element. Place an HTML comment inside or next to the
        // desired element in the format <!-- $attribute="value" -->

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'attributes';

        // default plugin options
        const options = {
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            // get list of comments in document
            const comments = findComments();

            for(const comment of comments)
                if (comment.parentElement)
                    addAttributes(
                        comment.parentElement,
                        comment.nodeValue.trim()
                    );
        }

        // add html attributes to specified element based on string of 
        // html attributes and values
        function addAttributes(element, text) {
            // regex's for finding attribute/value pairs in the format of
            // attribute="value" or attribute='value
            const regex2 = /\$([a-zA-Z\-]+)?=\"(.+?)\"/;
            const regex1 = /\$([a-zA-Z\-]+)?=\'(.+?)\'/;

            // loop through attribute/value pairs
            let match;
            while(match = text.match(regex2) || text.match(regex1)) {
                // get attribute and value from regex capture groups
                let attribute = match[1];
                let value = match[2];

                // remove from string
                text = text.substring(match.index + match[0].length);

                if (!attribute || !value)
                    break;

                // set attribute of parent element
                try {
                    element.setAttribute(attribute, value);
                } catch(error) {
                    console.log(error);
                }

                // special case for colspan
                if (attribute === 'colspan')
                    removeTableCells(element, value);
            }
        }

        // get list of comment elements in document
        function findComments() {
            const comments = [];

            // iterate over comment nodes in document
            function acceptNode(node) {
                return NodeFilter.FILTER_ACCEPT;
            }
            const iterator = document.createNodeIterator(
                document.body,
                NodeFilter.SHOW_COMMENT,
                acceptNode
            );
            let node;
            while(node = iterator.nextNode())
                comments.push(node);

            return comments;
        }

        // remove certain number of cells after specified cell
        function removeTableCells(cell, number) {
            number = parseInt(number);
            if (!number)
                return;

            // remove elements
            for(; number > 1; number--) {
                if (cell.nextElementSibling)
                    cell.nextElementSibling.remove();
            }
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>
<!-- math plugin configuration -->

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        "CommonHTML": { linebreaks: { automatic: true } },
        "HTML-CSS": { linebreaks: { automatic: true } },
        "SVG": { linebreaks: { automatic: true } },
        "fast-preview": { disabled: true }
    });
</script>

<!-- math plugin -->

<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML'>
    // /////////////////////////
    // DESCRIPTION
    // /////////////////////////

    // This third-party plugin 'MathJax' allows the proper rendering of
    // math/equations written in LaTeX.

    // https://www.mathjax.org/
</script>
<!-- annotations plugin configuration -->

<script>
    window.hypothesisConfig = function() {
        return {
            branding: {
                accentColor: '#2196f3',
                appBackgroundColor: '#f8f8f8',
                ctaBackgroundColor: '#f8f8f8',
                ctaTextColor: '#000000',
                selectionFontFamily: 'Open Sans, Helvetica, sans serif',
                annotationFontFamily: 'Open Sans, Helvetica, sans serif'
            }
        };
    };
</script>

<!-- annotations plugin -->

<script src='https://hypothes.is/embed.js'>
    // /////////////////////////
    // DESCRIPTION
    // /////////////////////////

    // This third-party plugin 'Hypothesis' allows public annotation of the
    // manuscript.

    // https://web.hypothes.is/
</script>
<!-- analytics plugin -->

<!-- copy and paste code from Google Analytics or similar service here -->
</body>
</html>
